<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.41">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>16&nbsp; Analysis of Variance (ANOVA) – Data Analysis for Food Science</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../chapters/week7/week_7.html" rel="next">
<link href="../../chapters/week6/model_formulation.html" rel="prev">
<link href="../../fda_favicon.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-48ffa3e5b9d089919c6712c39e5b00f2.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-030c138b47736e5750b8595abfdab90a.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../chapters/week6/week_6.html">Week 6</a></li><li class="breadcrumb-item"><a href="../../chapters/week6/anova.html"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Analysis of Variance (ANOVA)</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">Data Analysis for Food Science</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../chapters/week1/week_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 1</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/week1/r_basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">R Basics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/week1/descriptive_statistics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Descriptive statistics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/week1/debugging.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Debugging - Getting R to work</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/week1/plotting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Plotting</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/week1/pca.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Principal Component Analysis (PCA)</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../chapters/week2/week_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 2</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/week2/correlation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Correlation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/week2/normal_distribution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">The normal distribution</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/week2/central_limit_theorem.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Central limit theorem</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../chapters/week3/week_3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 3</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/week3/t_test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">T-test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/week3/hypothesis_testing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Hypothesis testing</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../chapters/week4/week_4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 4</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/week4/binomial_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Binomial data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/week4/poisson_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Poisson data</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../chapters/week5/week_5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 5</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/week5/mutinomial_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Multinomial data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/week5/power_calculation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Power calculation</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../chapters/week6/week_6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 6</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/week6/model_formulation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Model formulation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/week6/anova.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Analysis of Variance (ANOVA)</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../chapters/week7/week_7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 7</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/week7/regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/week7/least_squares.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Least squares</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../chapters/week8/week_8.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 8</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/week8/mlr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Multiple linear regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/week8/explained_variance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Explained variance</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/data_wrangling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Wrangling data in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/ggplot2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Plotting with ggplot2</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#intro-to-anova" id="toc-intro-to-anova" class="nav-link active" data-scroll-target="#intro-to-anova"><span class="header-section-number">16.1</span> Intro to ANOVA</a>
  <ul class="collapse">
  <li><a href="#model-formulation" id="toc-model-formulation" class="nav-link" data-scroll-target="#model-formulation"><span class="header-section-number">16.1.1</span> Model formulation</a></li>
  <li><a href="#hypothesis" id="toc-hypothesis" class="nav-link" data-scroll-target="#hypothesis"><span class="header-section-number">16.1.2</span> Hypothesis</a></li>
  <li><a href="#anova-table-and-test" id="toc-anova-table-and-test" class="nav-link" data-scroll-target="#anova-table-and-test"><span class="header-section-number">16.1.3</span> ANOVA table and test</a></li>
  <li><a href="#anova-with-several-factors" id="toc-anova-with-several-factors" class="nav-link" data-scroll-target="#anova-with-several-factors"><span class="header-section-number">16.1.4</span> ANOVA with several factors</a></li>
  <li><a href="#contrasts" id="toc-contrasts" class="nav-link" data-scroll-target="#contrasts"><span class="header-section-number">16.1.5</span> Contrasts</a></li>
  </ul></li>
  <li><a href="#reading-material" id="toc-reading-material" class="nav-link" data-scroll-target="#reading-material"><span class="header-section-number">16.2</span> Reading material</a>
  <ul class="collapse">
  <li><a href="#sec-anova-eisenberg" id="toc-sec-anova-eisenberg" class="nav-link" data-scroll-target="#sec-anova-eisenberg"><span class="header-section-number">16.2.1</span> Analysis of Variance (ANOVA) - <em>J David Eisenberg</em></a></li>
  <li><a href="#sec-anova-boone" id="toc-sec-anova-boone" class="nav-link" data-scroll-target="#sec-anova-boone"><span class="header-section-number">16.2.2</span> Anova in R - <em>Ed Boone</em></a></li>
  </ul></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises"><span class="header-section-number">16.3</span> Exercises</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../chapters/week6/week_6.html">Week 6</a></li><li class="breadcrumb-item"><a href="../../chapters/week6/anova.html"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Analysis of Variance (ANOVA)</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Analysis of Variance (ANOVA)</span></h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Learning objectives
</div>
</div>
<div class="callout-body-container callout-body">
<p>The learning objectives for this theme is to understand the statistical comparison of means from e.g.&nbsp;several different treatments. That is:</p>
<ul>
<li>ANOVA is based on separation of the total variance in the data.</li>
<li>The inferential test is relating the systematic variance with the random variance.</li>
<li>To grasp, that the ratio of variances can be tested in a F-distribution.</li>
<li>Be able to compare responses to several ”treatments”, by model specification, hypothesis formulation and testing.</li>
<li>Be able to validate model assumptions.</li>
<li>To understand the relation between t-test and one-way ANOVA, and use a one-way ANOVA model to do pairwise comparisons between treatment 1 and treatment 2, treatment 1 and treatment 3, and so forth.</li>
<li>To be able to compute anova with one or two factors.</li>
</ul>
<p>In short, ANOVA can be seen as an extention of the t-test. One-way ANOVA is for two sample t-test with more than two samples. And two-way anova is for paired t-test where there are more than just a pair.</p>
</div>
</div>
<section id="intro-to-anova" class="level2" data-number="16.1">
<h2 data-number="16.1" class="anchored" data-anchor-id="intro-to-anova"><span class="header-section-number">16.1</span> Intro to ANOVA</h2>
<section id="model-formulation" class="level3" data-number="16.1.1">
<h3 data-number="16.1.1" class="anchored" data-anchor-id="model-formulation"><span class="header-section-number">16.1.1</span> Model formulation</h3>
<p>Depending on the notes, there are several ways to write up the data for an ANOVA model. The following three versions are exactly similar for a setup with <span class="math inline">\(k\)</span> groups, and possibly not equal number of observations within each group. \</p>
Version 1:
<span class="math display">\[\begin{aligned}
X_{11},X_{12},X_{13},...,X_{1n_1} &amp;\sim \mathcal{N}(\mu_1,\sigma^2) \\
X_{21},X_{22},X_{23},...,X_{2n_2} &amp;\sim \mathcal{N}(\mu_2,\sigma^2) \\
&amp; \vdots \\
X_{k1},X_{k2},X_{k3},...,X_{kn_k} &amp;\sim \mathcal{N}(\mu_k,\sigma^2)
\end{aligned}\]</span>
<p>Version 2: <span class="math display">\[\begin{gather}
X_{ij}\sim  \mathcal{N}(\mu_i,\sigma^2)\\
\text{for } j=1,...,n_i \text{ and } i=1,..,k \nonumber
\end{gather}\]</span></p>
<p>Version 3: <span class="math display">\[\begin{gather}
X_{ij} = \mu_i + e_{ij} \nonumber \\
\text{where } e_{ij}\sim \mathcal{N}(0,\sigma^2) \text{ and  independent} \\
\text{for } j=1,...,n_i \text {and } i=1,..,k \nonumber
\end{gather}\]</span></p>
<p>For all three versions, the parameters describing the groups (<span class="math inline">\(\mu_i\)</span> for <span class="math inline">\(i=1,..,k\)</span>) and the dispersion within the groups (<span class="math inline">\(\sigma\)</span>) appear, and are exactly similar. Naturally, all three versions are correct, but in order to harmonize with notation for ANOVA with several factors and regression we stick with version 3.</p>
<p>For these models it is assumed that the residuals are coming from the <em>same</em> normal distribution. That is: <span class="math inline">\(e_{ij}\sim \mathcal{N}(0,\sigma^2)\)</span>. By construction, this distribution has mean equal to zero. Further it is assumed that these residuals are independent, that is: Changing one will not affect the others. If these two assumptions (same distribution and independent) are not fulfilled, the model is not valid, and we cannot trust the tests. Therefor this is checked by visual inspection of the residuals for normality (qq-plot, histogram, residuals vs.&nbsp;predicted value etc.) and independence (residuals vs.&nbsp;predicted value, line-plotting). As this is a very inherent part of model validation, it is made easy in R, where <code>plot()</code> on the object created by <code>aov()</code> or <code>lm()</code> produces graphics which can be used directly; fast’n’easy.</p>
</section>
<section id="hypothesis" class="level3" data-number="16.1.2">
<h3 data-number="16.1.2" class="anchored" data-anchor-id="hypothesis"><span class="header-section-number">16.1.2</span> Hypothesis</h3>
<p><span class="math inline">\(\mu_1,..,\mu_k\)</span> describes the center of each of the <span class="math inline">\(1,..,k\)</span> samples, and is naturally what is interesting to compare. Usually we are looking for differences between these means, why the null hypothesis is:</p>
<p><span class="math display">\[\begin{equation}
H0: \mu_1 = \mu_2 = ... =  \mu_k
\end{equation}\]</span></p>
<p>with the alternative, that at least one group .</p>
</section>
<section id="anova-table-and-test" class="level3" data-number="16.1.3">
<h3 data-number="16.1.3" class="anchored" data-anchor-id="anova-table-and-test"><span class="header-section-number">16.1.3</span> ANOVA table and test</h3>
<p>If we have two groups, the natural choice would be to use the differences between the observed means. However, for <span class="math inline">\(k\)</span> groups there are <span class="math inline">\(k(k-1)/2\)</span> combinations, why this approach would not lead to a single test, but merely <span class="math inline">\(k(k-1)/2\)</span> comparisons.</p>
<p>As an alternative for the differences between the observed means <span class="math inline">\(\bar{X}_1,...,\bar{X}_k\)</span>, the variance across these numbers are used (only totally true for groups of equal size), that is: <span class="math inline">\(MS_{bewteen} = var(\bar{X}_1,...,\bar{X}_k)\)</span>. If there is large differences between the group means, then this measure <span class="math inline">\(MS_{bewteen}\)</span> is big, and the null hypothesis should be discarded. Formalized, this needs to be compared to the variance within the groups, that is the average spread around the points.</p>
<p>It turns out, that this process can be seen as a partitioning (splitting) of the total variance in the entire dataset into</p>
<ol type="1">
<li>how much can be ascribed to the fact that samples are from different groups, and<br>
</li>
<li>how much which is caused by natural variation within the groups.</li>
</ol>
<p>A natural way to organize these variances is in an ANOVA table. That is a table including the Sum of Squares (SSQ), Degrees of Freedom (DF), Mean Square (MS), observed F-statistic (<span class="math inline">\(F_{obs}\)</span> ), and <span class="math inline">\(p\)</span>-value for each F-statistic <span class="math inline">\(Pr(F_{df_A,df_e}&gt;F_{obs})\)</span>. <a href="#tbl-one-way-anova" class="quarto-xref">table&nbsp;<span>16.1</span></a> corresponds to a one-way ANOVA table (an analysis with one factor).</p>
<div id="tbl-one-way-anova" class="table-sm quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-one-way-anova-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;16.1: ANOVA table for one-way analysis of variance.
</figcaption>
<div aria-describedby="tbl-one-way-anova-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table-sm small caption-top table">
<colgroup>
<col style="width: 11%">
<col style="width: 9%">
<col style="width: 16%">
<col style="width: 19%">
<col style="width: 17%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th>Source</th>
<th>SSQ</th>
<th>DF</th>
<th>MS</th>
<th><span class="math inline">\(F_{obs}\)</span></th>
<th><span class="math inline">\(Pr(F_{df_A,df_e}&gt;F_{obs})\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Factor(A)</td>
<td><span class="math inline">\(SS_A\)</span></td>
<td><span class="math inline">\(df_A = k-1\)</span></td>
<td><span class="math inline">\(MS_A = SS_A/df_A\)</span></td>
<td><span class="math inline">\(F_A = MS_A/MS_e\)</span></td>
<td><span class="math inline">\(p_A\)</span></td>
</tr>
<tr class="even">
<td>Residuals</td>
<td><span class="math inline">\(SS_e\)</span></td>
<td><span class="math inline">\(df_e = n-k\)</span></td>
<td><span class="math inline">\(MS_e = SS_e/df_e\)</span></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>Total</td>
<td><span class="math inline">\(SS_{tot}\)</span></td>
<td><span class="math inline">\(df_{tot} = n-1\)</span></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Here the total variance is described as the sums of squares across all samples</p>
<p><span class="math display">\[
SS_{tot} = \sum{(X_{ij} - \bar{\bar{X}})^2} \quad \text{for all} \quad j=1,...,n_i, \text{ and } i = 1,..,k,
\]</span></p>
<p>where <span class="math inline">\(\bar{\bar{X}}\)</span> is the overall average and <span class="math inline">\(X_{ij}\)</span> is the individual observations.</p>
<p>In the columns <em>Sum of squares</em> and <em>Degrees of freedom</em>, is the sum of the elements.</p>
<p>In the two sample t-test we use the pooled variance <span class="math inline">\(s_{X_{pooled}}^2\)</span>, In ANOVA this number is reflected by the residual variation <span class="math inline">\(MS_e\)</span>, which is also the estimate of <span class="math inline">\(\sigma^2\)</span> (I.e. <span class="math inline">\(\hat{\sigma}^2 = MS_e\)</span>).</p>
</section>
<section id="anova-with-several-factors" class="level3" data-number="16.1.4">
<h3 data-number="16.1.4" class="anchored" data-anchor-id="anova-with-several-factors"><span class="header-section-number">16.1.4</span> ANOVA with several factors</h3>
<p>Experiments often consist of several factors. For instance Coffee served at different <em>Temperatures</em> evaluated by different <em>Judges</em>, beer produced from different <em>Hops</em> and different <em>Yeast cultures</em> or oil stored at different <em>Temperature</em>, over <em>Time</em>, at different <em>Oxygen levels</em> and different <em>Light conditions</em>.</p>
<section id="model" class="level4">
<h4 class="anchored" data-anchor-id="model">Model</h4>
<p>Imagine an experiment with two factors: <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>, where <span class="math inline">\(A\)</span> has two levels, and <span class="math inline">\(B\)</span> has three levels, then the model is simply an extension of the one-way model:</p>
<p><span class="math display">\[\begin{gather}
X_{i} = \alpha(A_i) + \beta(B_i) + e_{i} \nonumber \\
\text{where } e_{i}\sim \mathcal{N}(0,\sigma^2) \text{ and independent} \\
\text{for } i=1,...,n \nonumber
\end{gather}\]</span></p>
<p>In this equation, <span class="math inline">\(\alpha()\)</span> describes the level with respect to <span class="math inline">\(A\)</span>, and has two levels: <span class="math inline">\(\alpha(A=1)\)</span> and <span class="math inline">\(\alpha(A=2)\)</span>, and <span class="math inline">\(\beta()\)</span> describes the level with respect to <span class="math inline">\(B\)</span>, and has three levels: <span class="math inline">\(\beta(B=1)\)</span>, <span class="math inline">\(\beta(B=2)\)</span> and <span class="math inline">\(\beta(B=3)\)</span>.</p>
</section>
<section id="hypotheses" class="level4">
<h4 class="anchored" data-anchor-id="hypotheses">Hypotheses</h4>
<p>The associated null hypothesis are:</p>
<ul>
<li>Factor A: <span class="math inline">\(H0: \alpha(A=1) = \alpha(A=2)= .... = \alpha(A=k_A)\)</span></li>
<li>Factor B: <span class="math inline">\(H0: \beta(B=1) = \beta(B=2)= .... = \beta(B=k_B)\)</span></li>
</ul>
</section>
<section id="anova-table" class="level4">
<h4 class="anchored" data-anchor-id="anova-table">ANOVA table</h4>
<p>In the test of these hypothesis, the ANOVA table is simply extend with rows in relation to these effects <a href="#tbl-two-way-anova" class="quarto-xref">table&nbsp;<span>16.2</span></a>.</p>
<div id="tbl-two-way-anova" class="table-sm quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-two-way-anova-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;16.2: ANOVA table for a two-way ANOVA.
</figcaption>
<div aria-describedby="tbl-two-way-anova-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table-sm small caption-top table">
<colgroup>
<col style="width: 13%">
<col style="width: 11%">
<col style="width: 6%">
<col style="width: 12%">
<col style="width: 13%">
<col style="width: 40%">
</colgroup>
<thead>
<tr class="header">
<th>Source</th>
<th>SSQ</th>
<th>DF</th>
<th>MS</th>
<th><span class="math inline">\(F_{obs}\)</span></th>
<th><span class="math inline">\(Pr(F_{df_{Source},df_e}&gt;F_{obs})\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Factor(A)</td>
<td><span class="math inline">\(SS_A\)</span></td>
<td><span class="math inline">\(df_A = k_A-1\)</span></td>
<td><span class="math inline">\(MS_A = SS_A/df_A\)</span></td>
<td><span class="math inline">\(F_A = MS_A/MS_e\)</span></td>
<td><span class="math inline">\(p_A\)</span></td>
</tr>
<tr class="even">
<td>Factor(B)</td>
<td><span class="math inline">\(SS_B\)</span></td>
<td><span class="math inline">\(df_B = k_B-1\)</span></td>
<td><span class="math inline">\(MS_B = SS_B/df_B\)</span></td>
<td><span class="math inline">\(F_B = MS_B/MS_e\)</span></td>
<td><span class="math inline">\(p_B\)</span></td>
</tr>
<tr class="odd">
<td>Residuals</td>
<td><span class="math inline">\(SS_e\)</span></td>
<td><span class="math inline">\(df_e = n-df_A - df_B - 1\)</span></td>
<td><span class="math inline">\(MS_e = SS_e/df_e\)</span></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>Total</td>
<td><span class="math inline">\(SS_{tot}\)</span></td>
<td><span class="math inline">\(df_{tot} = n-1\)</span></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</section>
<section id="interactions" class="level4">
<h4 class="anchored" data-anchor-id="interactions">Interactions</h4>
<p>For some experiments the effect of one factor might be dependent on the other factor, that is referred to as <em>interaction</em>. The interaction model for a two factor experiment is written as:</p>
<p><span class="math display">\[\begin{gather}
X_{i} = \alpha(A_i) + \beta(B_i) + \gamma(A_i,B_i) +  e_{i} \nonumber \\
\text{where } e_{i}\sim \mathcal{N}(0,\sigma^2) \text{ and independent} \\
\text{for } j=1,...,n \nonumber
\end{gather}\]</span></p>
<p>where <span class="math inline">\(\gamma()\)</span> describes the interaction between the two factor. In a model with e.g.&nbsp;<span class="math inline">\(2\)</span> and <span class="math inline">\(3\)</span> levels for the factors, this interaction term naturally has <span class="math inline">\(2\cdot 3 = 6\)</span> levels. However, in the model above, the main effects (<span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span>) are included, so that consumes some of the levels. Actually, this factor has <span class="math inline">\((k_A - 1)(k_B - 1)\)</span> levels.</p>
</section>
<section id="anova-table---interactions" class="level4">
<h4 class="anchored" data-anchor-id="anova-table---interactions">ANOVA table - interactions</h4>
<p>Testing the interaction leads to an extension of the ANOVA table, as seen in <a href="#tbl-two-way-anova-interaction" class="quarto-xref">table&nbsp;<span>16.3</span></a>.</p>
<div id="tbl-two-way-anova-interaction" class="table-sm quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-two-way-anova-interaction-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;16.3: ANOVA table for a two-way ANOVA with interaction.
</figcaption>
<div aria-describedby="tbl-two-way-anova-interaction-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table-sm small caption-top table">
<colgroup>
<col style="width: 7%">
<col style="width: 6%">
<col style="width: 37%">
<col style="width: 14%">
<col style="width: 13%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th>Source</th>
<th>SSQ</th>
<th>DF</th>
<th>MS</th>
<th><span class="math inline">\(F_{obs}\)</span></th>
<th><span class="math inline">\(Pr(F_{df_{Source},df_e}&gt;F_{obs})\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Factor(A)</td>
<td><span class="math inline">\(SS_A\)</span></td>
<td><span class="math inline">\(df_A = k_A-1\)</span></td>
<td><span class="math inline">\(MS_A = SS_A/df_A\)</span></td>
<td><span class="math inline">\(F_A = MS_A/MS_e\)</span></td>
<td><span class="math inline">\(p_A\)</span></td>
</tr>
<tr class="even">
<td>Factor(B)</td>
<td><span class="math inline">\(SS_B\)</span></td>
<td><span class="math inline">\(df_B = k_B-1\)</span></td>
<td><span class="math inline">\(MS_B = SS_B/df_B\)</span></td>
<td><span class="math inline">\(F_B = MS_B/MS_e\)</span></td>
<td><span class="math inline">\(p_B\)</span></td>
</tr>
<tr class="odd">
<td>Factor(A*B)</td>
<td><span class="math inline">\(SS_{AB}\)</span></td>
<td><span class="math inline">\(df_{AB} = (k_A-1)(k_B-1)\)</span></td>
<td><span class="math inline">\(MS_{AB} = SS_{AB}/df_{AB}\)</span></td>
<td><span class="math inline">\(F_{AB} = MS_{AB}/MS_e\)</span></td>
<td><span class="math inline">\(p_{AB}\)</span></td>
</tr>
<tr class="even">
<td>Residuals</td>
<td><span class="math inline">\(SS_e\)</span></td>
<td><span class="math inline">\(df_e = n-df_A - df_B - df_{AB} - 1 = n - (k_A)(k_B)\)</span></td>
<td><span class="math inline">\(MS_e = SS_e/df_e\)</span></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>Total</td>
<td><span class="math inline">\(SS_{tot}\)</span></td>
<td><span class="math inline">\(df_{tot} = n-1\)</span></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>We see that the only thing that changes is the sums of squares and the degrees of freedom for the residuals.</p>
<div class="callout callout-style-default callout-example no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Example 16.1 - Natural phenolic antioxidants for meat preservation - ANOVA
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<div id="exa-natural-phenolic-antiox-anova" class="callout-example">
<p>This example is based on the sensory data on the meat sausages treated with green tea (GT) and rosemary extract (RE) or control, used previously in example @#exa-natural-phenolic-antiox-paired-t-test.</p>
<p>A two-way anova can be used to evaluate the effect of several factors, and possible interaction effects on a single response variable. Here, we define a model with systematic effects of <em>Treatment</em> (3 levels), <em>Assessor</em> (8 levels) and <em>Week</em> (2 levels). Since it may be that the effect of the storage time differs for each of the antioxidant treatments, an interaciton effect between <em>Treatment</em> and <em>Week</em> is also included.</p>
<p>The starting model is therefore formulated as:</p>
<p><span class="math display">\[\begin{equation}
Y_i=\alpha (Treat_i)+\beta(Assessor_i)+\gamma(Week_i)+\theta(Treat_i\times Week_i)+e_i
\end{equation}\]</span></p>
<p>where <span class="math inline">\(e_i \sim \mathcal{N}(0,\sigma ^2)\)</span> and independent for <span class="math inline">\(i=1,\ldots,n\)</span></p>
<section id="plot-the-data" class="level4">
<h4 class="anchored" data-anchor-id="plot-the-data">Plot the data</h4>
<p>We wish to visualize three factors on a single response variable (<a href="#fig-smell-old-vs-treatment" class="quarto-xref">figure&nbsp;<span>16.1</span></a>). Here we use the x-axis for <em>Week</em> and <em>Treatment</em>, whereas the points are connected within <em>Assessor</em>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(X, <span class="fu">aes</span>(Treatment, Smell_Old, <span class="at">group =</span> Assessor)) <span class="sc">+</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">5</span>, <span class="fu">aes</span>(<span class="at">color =</span> week)) <span class="sc">+</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>week) <span class="sc">+</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> X[X<span class="sc">$</span>Treatment <span class="sc">==</span> <span class="st">"Control"</span>, ],</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> Assessor), </span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">hjust =</span> <span class="fl">1.5</span> <span class="co"># Move the labels a little to the left</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-smell-old-vs-treatment" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-smell-old-vs-treatment-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="anova_files/figure-html/fig-smell-old-vs-treatment-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;16.1: Feedback on Smell_Old for all judges as a function of treatment. The plot is divided into week 0 and week 4."><img src="anova_files/figure-html/fig-smell-old-vs-treatment-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-smell-old-vs-treatment-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.1: Feedback on <em>Smell_Old</em> for all judges as a function of treatment. The plot is divided into week 0 and week 4.
</figcaption>
</figure>
</div>
</div>
</div>
<p>From the figure there are a few observations: First, some assessors (e.g.~128 and 197) use the entire range whereas some only scores in a narrow range (e.g.~12, 193 and 187). Generally it seems as the control treatment (at both time points) obtain higher scores compared to the treated samples. There are no apparent indications for the two treatments being different.</p>
</section>
<section id="calculate-two-way-anova" class="level4">
<h4 class="anchored" data-anchor-id="calculate-two-way-anova">Calculate two-way ANOVA</h4>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page">Using base R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Using Tidyverse</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute ANOVA using specified model:</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Smell_Old = Assessor + Treatment + Week + Treatment * Week</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">aov</span>(Smell_Old <span class="sc">~</span> <span class="fu">factor</span>(Assessor) <span class="sc">+</span> <span class="fu">factor</span>(Treatment) <span class="sc">*</span> <span class="fu">factor</span>(week),</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">data =</span> X)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Show ANOVA table</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: Smell_Old
                               Df  Sum Sq Mean Sq F value   Pr(&gt;F)   
factor(Assessor)                7  77.833  11.119  1.9861 0.086116 . 
factor(Treatment)               2  70.153  35.077  6.2653 0.004826 **
factor(week)                    1   5.629   5.629  1.0054 0.323084   
factor(Treatment):factor(week)  2   1.062   0.531  0.0948 0.909763   
Residuals                      34 190.352   5.599                    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Important! The <code>factor()</code> calls are important as they convert the variables from numeric/strings to factors. What happens if you remove <code>factor()</code>?</p>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Turn column "Assessor", "Treatment" and "week" into factors</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> X <span class="sc">|&gt;</span> </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(Assessor, Treatment, week), factor))</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute ANOVA using specified model:</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Smell_Old = Assessor + Treatment + Week + Treatment * Week</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">aov</span>(Smell_Old <span class="sc">~</span> Assessor <span class="sc">+</span> Treatment <span class="sc">*</span> week,</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">data =</span> X)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Show ANOVA table</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit)          </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: Smell_Old
               Df  Sum Sq Mean Sq F value   Pr(&gt;F)   
Assessor        7  77.833  11.119  1.9861 0.086116 . 
Treatment       2  70.153  35.077  6.2653 0.004826 **
week            1   5.629   5.629  1.0054 0.323084   
Treatment:week  2   1.062   0.531  0.0948 0.909763   
Residuals      34 190.352   5.599                    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>Here it can be seen that the only effect which is found significant (<span class="math inline">\(p &lt; 0.05\)</span>) for the <em>Old_Smell</em> response is the <em>Treatment</em> factor. No significance was found for the <em>Week</em> or interaction factors. The <em>Assessor</em> effect is not strictly signifcant, but on the borderline (<span class="math inline">\(p=0.09\)</span>). If we plot the raw data (<a href="#fig-smell-old-vs-treatment" class="quarto-xref">figure&nbsp;<span>16.1</span></a>), it seems each of the assesors have different base levels of scoring the old smell descriptor. Therefore, it is chosen to keep the systematic effect of <em>Assessor</em> in the model. Furthermore, it can be seen that there is some variation in the <em>Assessor</em> evaluation of the treatment effect (non-parallel), indicating that the sensory panel is not very precise, and may be poorly trained.</p>
</section>
<section id="final-model" class="level4">
<h4 class="anchored" data-anchor-id="final-model">Final model</h4>
<p>The final model is therefore the model only including the effects of the treatment and <em>Assessor</em> factors:</p>
<p><span class="math display">\[\begin{equation}
Y_i=\alpha (Treat_i)+\beta(Assessor_i)+e_i
\end{equation}\]</span></p>
<p>where <span class="math inline">\(e_i \sim \mathcal{N}(0,\sigma^2)\)</span> and independent for <span class="math inline">\(i=1,\ldots,n\)</span>.</p>
<p>The estimates for the factors (<span class="math inline">\(\alpha(Control),\alpha(GT), \alpha(RE), \beta(Ass12),\ldots,\beta(193)\)</span>) as well as the standard deviation (<span class="math inline">\(\hat{\sigma}\)</span>) can be obtained by first calculating a new model including only significant terms followed by the <em>anova()</em> and <em>summary()</em> commands.</p>
</section>
</div>
</div>
</div>
</div>
<!-- End example callout -->
</section>
</section>
<section id="contrasts" class="level3" data-number="16.1.5">
<h3 data-number="16.1.5" class="anchored" data-anchor-id="contrasts"><span class="header-section-number">16.1.5</span> Contrasts</h3>
<p>If it turns out that there is a significant effect of the factor, a natural next step is to compare the individual levels by estimation of confidence intervals and/or testing differences. This is quite similar to comparing two means by t-test. The only difference is, that <span class="math inline">\(\hat{\sigma}^2 = MS_e\)</span> is used as the measure of random uncertainty (instead of <span class="math inline">\(s_{X_{pooled}}^2\)</span>), and the degrees of freedom is NOT <span class="math inline">\(n_1 + n_2 - 2\)</span>, but the degrees of freedom associated with the uncertainty estimate: <span class="math inline">\(df_e\)</span>. Apart from that, the method is similar.</p>
<p>Assume that <em>Factor(A)</em> has five levels, then the comparison of e.g.&nbsp;level <span class="math inline">\(2\)</span> and <span class="math inline">\(5\)</span> is done as follows:</p>
<section id="confidence-intervals" class="level4">
<h4 class="anchored" data-anchor-id="confidence-intervals">Confidence intervals</h4>
<p><span class="math display">\[\begin{equation}
\bar{X_5} - \bar{X_2} \pm t_{1 - \alpha/2,df_e}\sqrt{MS_e}\sqrt{\frac{1}{n_5} + \frac{1}{n_2}}
\end{equation}\]</span></p>
<p>Where <span class="math inline">\(t_{1 - \alpha/2,df_e}\)</span> is the t-fractile at a user-specified level <span class="math inline">\(\alpha\)</span> with <span class="math inline">\(df_e\)</span> degrees of freedom.</p>
</section>
<section id="test-of-contrast" class="level4">
<h4 class="anchored" data-anchor-id="test-of-contrast">Test of contrast</h4>
<p>The associated hypothesis are stated as:</p>
<p><span class="math display">\[\begin{equation}
H_0: \mu_5=\mu_2
\end{equation}\]</span></p>
<p>With the alternative:</p>
<p><span class="math display">\[\begin{equation}
H_A: \mu_5 \neq \mu_2
\end{equation}\]</span></p>
<p>Then the test statistics is calculated as: <span class="math display">\[\begin{equation}
t_{obs} = \frac{\bar{X_5} - \bar{X_2}} {\sqrt{MS_e}\sqrt{\frac{1}{n_5} + \frac{1}{n_2}}}
\end{equation}\]</span> With the associated (2-sided) p-value: <span class="math inline">\(p = 2 \cdot P(\mathcal{T}_{df=df_e}&gt;t_{obs})\)</span>.</p>
<div class="callout callout-style-default callout-example no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Example 16.2 - Natural phenolic antioxidants for meat preservation - contrasts
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<div id="exa-natual-phenolic-antiox-contrasts" class="callout-example">
<p>In this example, we wish to compare pairs of levels within a factor from an ANOVA model. In <a href="anova.html#exa-natural-phenolic-antiox-anova">Example 16.1</a> the <em>Treatment</em> effect from a two way model as shown below is significant, however, that does not imply that all levels are different, but only that at least a single strikes out.</p>
<p>We start by computing the ANOVA and assigning it to the variable <code>fit</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute ANOVA</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">aov</span>(Smell_Old <span class="sc">~</span> <span class="fu">factor</span>(Assessor) <span class="sc">+</span> <span class="fu">factor</span>(Treatment),</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">data =</span> X)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Print ANOVA table</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: Smell_Old
                  Df  Sum Sq Mean Sq F value   Pr(&gt;F)   
factor(Assessor)   7  77.833  11.119  2.0879 0.069457 . 
factor(Treatment)  2  70.153  35.077  6.5866 0.003573 **
Residuals         37 197.043   5.325                    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>We can use <code>model.tables()</code> to get means for each level of each factor.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Show means across both factors</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">model.tables</span>(fit, <span class="at">type =</span> <span class="st">"means"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Tables of means
Grand mean
         
3.025532 

 factor(Assessor) 
       12   128   147 149   187   190   193   197
    5.725 2.312 2.237 1.1 3.062 2.763 3.187 3.975
rep 6.000 6.000 6.000 6.0 6.000 6.000 6.000 5.000

 factor(Treatment) 
    Control     GT     RE
      4.752  1.865  2.568
rep  15.000 16.000 16.000</code></pre>
</div>
</div>
<p>The rows of numbers contain the means across each level. <code>rep</code> is the number of observations.</p>
<section id="contrasts-1" class="level4">
<h4 class="anchored" data-anchor-id="contrasts-1">Contrasts</h4>
<p>We wish to compare the treatments <em>RE</em> and <em>GT</em>. This a basically a two sample t-test, just where the entire dataset and model is used to calculate the standard deviation.</p>
<p>The hypothesis are: <span class="math display">\[
H_0: \mu_{GT}=\mu_{RE} \quad \text{and} \quad H_A: \mu_{GT} \neq \mu_{RE}
\]</span></p>
<p>Naturally, the driver of this test is the observed difference between the two means. In total the test-statistics amount to:</p>
<p><span class="math display">\[\begin{equation}
t_{obs} = \frac{\bar{X}_{GT} - \bar{X}_{RE}} {\sqrt{MS_e}\sqrt{\frac{1}{n_{GT}} + \frac{1}{n_{RE}}}}
\end{equation}\]</span></p>
<p>With the associated (2-sided) p-value:</p>
<p><span class="math display">\[
p = 2 \cdot P(\mathcal{T}_{df=df_e}&gt;t_{obs})
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fl">1.86</span> <span class="co"># GT mean</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fl">2.57</span> <span class="co"># RE mean</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="dv">16</span> <span class="co"># GT n</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> <span class="dv">16</span> <span class="co"># RE n</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fl">5.325</span>) <span class="co"># SD from ANOVA table</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="dv">37</span> <span class="co"># DF for residuals</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>t_obs <span class="ot">&lt;-</span> (m1 <span class="sc">-</span> m2) <span class="sc">/</span> (s<span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">/</span>n1 <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span>n2)) <span class="co"># Test statistic</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pt</span>(<span class="fu">abs</span>(t_obs),df)) <span class="co"># p-value for GT vs RE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3897755</code></pre>
</div>
</div>
<p>In line with the raw data, the observed difference between the two treatments, is not statistically singificant, and we conclude that the two treatments has similar properties in terms of <em>Old_Smell</em>.</p>
</section>
<section id="confidence-interval-on-difference-between-re-and-control" class="level4">
<h4 class="anchored" data-anchor-id="confidence-interval-on-difference-between-re-and-control">Confidence interval on difference between RE and Control</h4>
<p>As an alternative, the confidence interval on the difference between two means can be calculated. As example this is done for RE vs Control.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>m3 <span class="ot">&lt;-</span> <span class="fl">4.75</span> <span class="co"># Control mean</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>n3 <span class="ot">&lt;-</span> <span class="dv">15</span> <span class="co"># Control n</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>CIlow <span class="ot">&lt;-</span> m3 <span class="sc">-</span> m2 <span class="sc">-</span> <span class="fu">qt</span>(<span class="fl">0.975</span>,df)<span class="sc">*</span>s<span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">/</span>n2 <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span>n3) <span class="co"># lower bound</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>CIhigh <span class="ot">&lt;-</span> m3 <span class="sc">-</span> m2 <span class="sc">+</span> <span class="fu">qt</span>(<span class="fl">0.975</span>,df)<span class="sc">*</span>s<span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">/</span>n2 <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span>n3) <span class="co"># upper bound</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(CIlow,CIhigh)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4995882 3.8604118</code></pre>
</div>
</div>
<p>We see that the confidence interval on the difference between the control and RE treated samples are positive and do not overlap <span class="math inline">\(0\)</span>, that is, in general the control samples has a higher score with respect to <em>Old_Smell</em> and further that this is a significant difference on <span class="math inline">\(95\%\)</span> level.</p>
</section>
</div>
</div>
</div>
</div>
<!-- End example callout -->
</section>
</section>
</section>
<section id="reading-material" class="level2" data-number="16.2">
<h2 data-number="16.2" class="anchored" data-anchor-id="reading-material"><span class="header-section-number">16.2</span> Reading material</h2>
<ul>
<li>A brief video going through the concepts of both one-way and two-way ANOVA:
<ul>
<li><a href="#sec-anova-eisenberg">Analysis of Variance (ANOVA)</a></li>
</ul></li>
<li>A video going through how to do ANOVA in R:
<ul>
<li><a href="#sec-anova-boone">ANOVA in R</a></li>
</ul></li>
<li>Chapter 8 of <a href="https://02402.compute.dtu.dk/enotes/book-IntroStatistics"><em>Introduction to Statistics</em></a> by Brockhoff</li>
</ul>
<section id="sec-anova-eisenberg" class="level3" data-number="16.2.1">
<h3 data-number="16.2.1" class="anchored" data-anchor-id="sec-anova-eisenberg"><span class="header-section-number">16.2.1</span> Analysis of Variance (ANOVA) - <em>J David Eisenberg</em></h3>
<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/ITf4vHhyGpc" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
</section>
<section id="sec-anova-boone" class="level3" data-number="16.2.2">
<h3 data-number="16.2.2" class="anchored" data-anchor-id="sec-anova-boone"><span class="header-section-number">16.2.2</span> Anova in R - <em>Ed Boone</em></h3>
<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/Dwd3ha0P8uw" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
</section>
</section>
<section id="exercises" class="level2" data-number="16.3">
<h2 data-number="16.3" class="anchored" data-anchor-id="exercises"><span class="header-section-number">16.3</span> Exercises</h2>
<div class="callout callout-style-default callout-exercise no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise 16.1 - ANOVA
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<div id="ex-anova" class="callout-exercise">
<p>Load <code>Results panel.xlsx</code>. Look at the study design and:</p>
<div class="callout callout-style-default callout-task no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tasks
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<div class="callout-task">
<ol type="1">
<li>Formulate a One-way ANOVA model for the coffees served at different <em>Temperatures</em> and the response <em>bitter</em>.</li>
<li>Formulate null-hypothesis and alternative hypothesis between the different coffee temperatures.</li>
<li>Test the hypothesis.</li>
<li>Formulate a Two-way ANOVA model for the taste of bitter with the two factors; <em>Temperature</em> and <em>Judge</em></li>
<li>Formulate null-hypothesis and alternative hypothesis.</li>
</ol>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<!-- End exercise callout -->
<div class="callout callout-style-default callout-exercise no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise 16.2 - Wine and one-way ANOVA
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<div id="ex-wine-and-one-way-anova" class="callout-exercise">
<p>Wines from four different countries (Argentina, Australia, Chile and South Africa) were analyzed for aroma compounds with GC-MS (gas chromatography coupled with mass spectrometry). The dataset can be found in the file “Wine.xlsx”. The wine data should already be familiar to you otherwise look at the exercises from week 1 and 2.</p>
<div class="callout callout-style-default callout-task no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tasks
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<div class="callout-task">
<ol type="1">
<li>When working with ANOVA which assumption is then made about the data, and how does the model look?</li>
<li>We would like to investigate if the wines from the four different countries are different. State the null hypothesis and the alternative hypothesis.</li>
<li>Make a combined jitter and boxplot on the variable <em>X3.Hexenol</em>. Are there any suspicious samples?</li>
<li>Make an ANOVA on <em>X3.Hexenol</em>, look at the <code>summary()</code> and draw conclusions.</li>
<li>Compare the result with the boxplot from Q3. Was the result of the ANOVA expected? If yes; why?</li>
<li>We would like to state which countries are significantly different from the others. For this you need to install the R-package <code>multcomp</code>. Use the command <code>TukeyHSD()</code> to investigate the differences/contrasts between the countries. Use the confidence intervals for judging differences.</li>
<li>Which countries are significantly different and which are not? Compare with the boxplot produced in Q3.</li>
<li>Make the boxplot and the ANOVA for the following variables too; <em>Diethyl.succinate</em>, <em>X1.Hexanol</em>, <em>Ethyl.hexanoate</em> and <em>Ethyl.propanoate</em>. Are any of these variables different between countries?</li>
<li>Check for normality of the model residuals by making a qq-plot.
<ul>
<li>Hint: You need to extract the residuals from the model, for instance by the function <code>resid()</code>. Use <code>qqnorm()</code> and <code>qqline()</code> to make the plot.</li>
</ul>
<ol type="a">
<li>Can we trust the assumption about normality?</li>
<li>After doing this manually, try the function <code>plot()</code> on the <code>aov()</code> object, which produces four plots for assumption checking.</li>
</ol></li>
<li>For some of the results, the jitter plot indicates, a few extreme samples. What happens if these are removed? Does the conclusions change?</li>
</ol>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<!-- End exercise callout -->
<div class="callout callout-style-default callout-exercise no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise 16.3 - Diet and fat metabolism - ANOVA
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<div id="ex-diet-and-fat-metabolism-anova" class="callout-exercise">
<p>The diet is a central factor involved in general health, and especially in relation to obesity, where a balance between intake of protein, fat and carbohydrates, as well as types of these nutrients seems important. Therefore various controlled studies are conducted to show the effect of different diets. A study examining the effect of protein from milk (casein or whey) and amount of fat on growth biomarkers of fat metabolism and type I diabetes was conducted in 40 mice over an intervention period of 14 weeks.</p>
<p>The data for this exercise is the same as for <span class="citation" data-cites="ex-diet-and-fat-metabolism-in-r">(<a href="#ref-ex-diet-and-fat-metabolism-in-r" role="doc-biblioref"><strong>ex-diet-and-fat-metabolism-in-r?</strong></a>)</span>.</p>
<p>For this exercise we are going to focus on cholesterol as a biomarker related to fat metabolism, and on three types of diet:</p>
<ol type="1">
<li>High fat with the milk protein casein <em>HF casein</em> (n=15).</li>
<li>High fat with whey protein from milk <em>HF whey</em> (n=15).</li>
<li>Low fat with the milk protein casein <em>LF casein</em> (n=10).</li>
</ol>
<p>The cholesterol level at the end of the 14 week intervention is listed in <span class="quarto-unresolved-ref">?tbl-tbl-diets-summary</span> including some descriptive stats.</p>
<div id="tbl-diets-summary" class="table-sm quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-diets-summary-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;16.4: Some summary statistics for cholesterol across the three diets.
</figcaption>
<div aria-describedby="tbl-diets-summary-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table-sm small caption-top table">
<colgroup>
<col style="width: 19%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 3%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 3%">
<col style="width: 4%">
<col style="width: 8%">
<col style="width: 19%">
<col style="width: 8%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: right;">1</th>
<th style="text-align: center;">2</th>
<th style="text-align: right;">…</th>
<th style="text-align: right;">9</th>
<th style="text-align: right;">10</th>
<th style="text-align: center;">11</th>
<th style="text-align: right;">…</th>
<th style="text-align: right;">15</th>
<th style="text-align: right;"><span class="math inline">\(\sum{X}\)</span></th>
<th style="text-align: right;"><span class="math inline">\(\sum{(X - \bar{X})^2}\)</span></th>
<th style="text-align: right;"><span class="math inline">\(\bar{X}\)</span></th>
<th style="text-align: right;"><span class="math inline">\(s_{X}\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Cholesterol (HF casein)</td>
<td style="text-align: right;">4.68</td>
<td style="text-align: center;">3.60</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">4.60</td>
<td style="text-align: right;">4.84</td>
<td style="text-align: center;">4.84</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">4.37</td>
<td style="text-align: right;">67.29</td>
<td style="text-align: right;">4.06</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">Cholesterol (HF whey)</td>
<td style="text-align: right;">3.79</td>
<td style="text-align: center;">2.82</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">3.77</td>
<td style="text-align: right;">4.63</td>
<td style="text-align: center;">3.44</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">3.24</td>
<td style="text-align: right;">54.86</td>
<td style="text-align: right;">4.69</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">Cholesterol (LF casein)</td>
<td style="text-align: right;">3.97</td>
<td style="text-align: center;">3.69</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">3.62</td>
<td style="text-align: right;">3.53</td>
<td style="text-align: center;">…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">34.37</td>
<td style="text-align: right;">2.07</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>The total sums of squares is: <span class="math inline">\(SS_{tot} = \sum{(X_{ij} - \bar{\bar{X}})^2} = 18.99\)</span>.</p>
<p>The first six questions are supposed to be done <em>by hand</em> where the computer only is used as a pocket calculator.</p>
<div class="callout callout-style-default callout-task no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tasks
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<div class="callout-task">
<ol type="1">
<li>Calculate descriptive statistics for the three groups
<ul>
<li>Hint: Fill in the table the missing values in <a href="#tbl-diets-summary" class="quarto-xref">table&nbsp;<span>16.4</span></a>.</li>
</ul></li>
<li>Sketch these results in a graph (by pen and paper - no computer).</li>
<li>State a model for these data, and a hypothesis of similarity between the three dietary treatments (with regards to cholesterol level).</li>
<li>Construct an ANOVA table and calculate and fill in the numbers including test statistics (<span class="math inline">\(F_{obs}\)</span>) and the corresponding p-value.
<ul>
<li>For the translation of <span class="math inline">\(F_{obs}\)</span> to <span class="math inline">\(p\)</span>, use the function <code>pf()</code> in R.</li>
</ul></li>
<li>This p-value should be significant. Guided by the initial descriptive stats, do you believe that all three diets are different? Or is there two groups which are close in estimate?</li>
<li>Formulate a hypothesis of similarity between the two most similar groups. Test this contrast.</li>
</ol>
</div>
</div>
</div>
</div>
<p>The data can be found in the file <code>Mouse_diet_intervention.xlsx</code>.</p>
<div class="callout callout-style-default callout-task no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tasks
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<div class="callout-task">
<ol start="7" type="1">
<li>Import the data, and make a plot of cholesterol (<code>$cholesterol</code>) and dietary intervention (<code>$Fat_Protein</code>)</li>
<li>Repeat the ANOVA analysis using R with the function <code>aov()</code> for construction of model and the function <code>anova()</code> for analysis of this model.</li>
<li>Check that the model assumptions are ok.
<ul>
<li><code>plot(model)</code> where <code>model</code> is the object created by <code>aov()</code>.</li>
</ul></li>
<li>For the individual contrasts you can use the function <code>TukeyHSD()</code> on the model.
<ul>
<li>Be aware that the p-values in this analysis is adjusted for multiple testing, and therefore are bigger than the ones done one by one.</li>
</ul></li>
<li>Based on these results, which dietary component do you think causes differences in cholesterol level?</li>
<li>There are some indications of differences between <em>HF whey</em> and <em>LF casein</em>, however, not significant. How many samples would have been needed in order to achieve significance with an appropriate power level?</li>
</ol>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<!-- End exercise callout -->
<div class="callout callout-style-default callout-exercise no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-12-contents" aria-controls="callout-12" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise 16.4 - Diet and fat metabolism - multivariate ANOVA
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-12" class="callout-12-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<div id="ex-diet-and-fat-metabolism-anova-multivariate" class="callout-exercise">
<p>In this exercise, we are going to extend the analysis from <a href="anova.html#ex-diet-and-fat-metabolism-anova">Exercise 16.3</a> to include several biomarkers.</p>
<div class="callout callout-style-default callout-task no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-11-contents" aria-controls="callout-11" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tasks
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-11" class="callout-11-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<div class="callout-task">
<ol type="1">
<li>Start out by construction of a PCA on the biomarkers: <code>insulin</code>, <code>cholesterol</code>, <code>triglycerides</code>, <code>NEFA</code>, <code>glucose</code> and <code>HbA1c</code> (NEFA = nonesterified fatty acids), including all 40 samples, and comment on the results with respect to differences between diets. This is computationally identical to the task in <span class="citation" data-cites="ex-diet-and-fat-metabolism-in-r">(<a href="#ref-ex-diet-and-fat-metabolism-in-r" role="doc-biblioref"><strong>ex-diet-and-fat-metabolism-in-r?</strong></a>)</span>.</li>
<li>Repeat the ANOVA for several biomarkers including plotting.</li>
<li>Zack out the components in the PCA model and glue them together with the original data (use <code>cbind()</code>).
<ul>
<li>You can find inspiration on how to do this in <span class="citation" data-cites="ex-mcdonalds-data">(<a href="#ref-ex-mcdonalds-data" role="doc-biblioref"><strong>ex-mcdonalds-data?</strong></a>)</span>.</li>
</ul></li>
<li>Use the components from the PCA model as response variables, and repeat the ANOVA (including plotting).</li>
<li>Comment on the similarity / dis-similarity between the univariate results, and the ones based on the PCA.</li>
<li>Compare the results (plot and ANOVA) for PC1 and PC6. Why do you think the dietary signal is more pronounced in the first component?
<ul>
<li>Hint: Think of how much, and which type of variation that is captured in the individual components.</li>
</ul></li>
</ol>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<!-- End exercise callout -->
<div class="callout callout-style-default callout-exercise no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-14-contents" aria-controls="callout-14" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise 16.5 - Analysis of coffee serving temperature
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-14" class="callout-14-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<div id="ex-analysis-of-coffee-serving-temperature" class="callout-exercise">
<p>Serving temperature of coffee seems of importance of how this drink is perceived. However, it is not totally clear how this relation is. In order to understand this, studies on the same type of coffee served at different temperature is conducted. In this exercise we are going to use the data from a trained Panel of eight judges, evaluating coffee served at six different temperatures on a set of sensorical descriptors. Each judge is presented with each temperature in a total of four replicates leading to a total of <span class="math inline">\(6 \times 8 \times 4 = 192\)</span> samples.</p>
<p>In the dataset <code>Results Panel.xlsx</code> the results are listed. In this exercise we are going to analyse the differences between the individual temperatures while utilizing the design of repeated scoring by the same judges. This exercise is an extension of <span class="citation" data-cites="ex-coffee-serving-temp">(<a href="#ref-ex-coffee-serving-temp" role="doc-biblioref"><strong>ex-coffee-serving-temp?</strong></a>)</span> from week one.</p>
<div class="callout callout-style-default callout-task no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-13-contents" aria-controls="callout-13" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tasks
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-13" class="callout-13-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<div class="callout-task">
<ol type="1">
<li>We want to summarize data, such that each judge have <em>one</em> score for each coffee sample and each attribute (instead of four).
<ul>
<li>You can use the <code>aggregate()</code> function to average over replicates, which is to retain <code>Assessor</code> and <code>Sample</code>.</li>
</ul></li>
<li>Plot this descriptive measure for <code>Intensity</code> across temperature (x-axis) and join the points from the same judge.</li>
<li>Make an ANOVA model with the response <code>Intensity</code> including both factors (<code>Temperature</code> and <code>Judge</code>).</li>
<li>Check out what the function <code>factor()</code> is doing? What happens if it is removed (check the degrees of freedoms consumed by the two options).</li>
<li>Check that the model assumptions are ok. (<code>plot(model)</code> where <code>model</code> is the object created by <code>aov()</code>).</li>
<li>Comment on these results (in relation to Temperature and Judge).</li>
<li>Use this data as input for construction of a PCA model, and make a bi-plot.</li>
<li>What do you see with respect to differences in temperature and judges?</li>
<li>Zack out the first couple of component and glue them together with the original data.</li>
<li>Make ANOVA model for component 1 to 5 and find the component with the strongest <code>Temperature</code> and <code>Judge</code> signature respectively.</li>
<li>Plot the PCA model with these two components (This is specified by the option <code>choice = ...</code>). Color this plot according to <code>Temperature</code> and <code>Judge</code>.</li>
<li>Which sensorical markers seems mostly related to differences between <code>Temperature</code> and <code>Judge</code> respectively?</li>
</ol>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<!-- End exercise callout -->
<div class="callout callout-style-default callout-exercise no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-17-contents" aria-controls="callout-17" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise 16.6 - Carcass suspension
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-17" class="callout-17-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<div id="ex-carcass-suspension" class="callout-exercise">
<p>Toughness is found to be the most important quality characteristic in beef. Variation in toughness is primarily related to the muscle fibers and the connective tissue. Connective tissue is thought to be responsible for the relative fixed background toughness, largely affected by animal age. The toughness of the muscle fibers depends on a couple of factors and is more likely to be manipulated by e.g.&nbsp;carcass suspension to prevent post-mortem contraction of the muscle fibers.</p>
<p>An experiment was conducted in order to test the effects of Animal Age, Carcass Suspension and the interaction between Animal Age and Carcass Suspension. The muscle of interest was longissimus dorsi. The hypothesis for the experiment was that pelvic suspension would prevent post-mortem contraction of the muscle fibers and thereby result in a more tender longissimus dorsi compared with suspension in the Achilles tendon. Furthermore, the toughness was believed to increase with increasing age. This increase in toughness was assigned to connective tissue.</p>
<p>In the experiment, animals were slaughtered and the carcasses were spilt. One side was suspended in in the pelvic bone (<a href="#fig-carcass" class="quarto-xref">figure&nbsp;<span>16.2</span></a>, left) and the other side was suspended in the Achilles tendon (<a href="#fig-carcass" class="quarto-xref">figure&nbsp;<span>16.2</span></a>, right). The experiment was balanced and 15 carcass sides were assigned to each group.</p>
<div style="width: 50%; margin: auto; text-align: center;">
<div id="fig-carcass" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-carcass-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="carcass.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Figure&nbsp;16.2: Left: Pelvic suspension. Right: Achilles suspension."><img src="carcass.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-carcass-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.2: Left: Pelvic suspension. Right: Achilles suspension.
</figcaption>
</figure>
</div>
</div>
<p>In the <a href="#tbl-carcass-results" class="quarto-xref">table&nbsp;<span>16.5</span></a> are shown the average results from each cell in the design.</p>
<div id="tbl-carcass-results" class="table-sm quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-carcass-results-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;16.5: Mean values for the design (n = 15 in each group)
</figcaption>
<div aria-describedby="tbl-carcass-results-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table-sm small caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">Suspension</th>
<th style="text-align: right;">Age 2y</th>
<th style="text-align: right;">Age 3y</th>
<th style="text-align: right;">Age 4y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Pelvic (A)</td>
<td style="text-align: right;">58.5</td>
<td style="text-align: right;">65.0</td>
<td style="text-align: right;">66.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Achilles (B)</td>
<td style="text-align: right;">72.0</td>
<td style="text-align: right;">82.5</td>
<td style="text-align: right;">93.0</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<div class="callout callout-style-default callout-task no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-15-contents" aria-controls="callout-15" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tasks
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-15" class="callout-15-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<div class="callout-task">
<ol type="1">
<li>Sketch these results with the response on the y-axis, one factor on the x-axis, and join the points based on the other factor. What is your first impression on the effect of age of the animal and of suspension method.
<ul>
<li>Further, does the lines seem to be deviating from being parallel? (This indicates interaction between the factors).</li>
</ul></li>
<li>Write up a model including interaction term.</li>
<li>Write up the <span class="math inline">\(H0\)</span> (and the alternative) hypotheses for the main effects in this experiment.</li>
</ol>
</div>
</div>
</div>
</div>
<div id="tbl-shear-force" class="table-sm quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-shear-force-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;16.6: ANOVA table for response <code>shear force</code>.
</figcaption>
<div aria-describedby="tbl-shear-force-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table-sm small caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">Source</th>
<th style="text-align: right;">SS</th>
<th style="text-align: right;">df</th>
<th style="text-align: right;">MS</th>
<th style="text-align: right;">F</th>
<th style="text-align: right;">p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Age</td>
<td style="text-align: right;">3083.7</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Suspension</td>
<td style="text-align: right;">8410.0</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Age*Suspension</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Error</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;">375.0</td>
<td style="text-align: right;">-</td>
<td style="text-align: right;">-</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Total</td>
<td style="text-align: right;">43715.0</td>
<td style="text-align: right;">89</td>
<td style="text-align: right;">-</td>
<td style="text-align: right;">-</td>
<td style="text-align: right;">-</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<div class="callout callout-style-default callout-task no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-16-contents" aria-controls="callout-16" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tasks
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-16" class="callout-16-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<div class="callout-task">
<ol start="4" type="1">
<li>Fill the missing values in the <a href="#tbl-shear-force" class="quarto-xref">table&nbsp;<span>16.6</span></a>.</li>
<li>What factors are having a significant effect (significance level of 0.05)?</li>
<li>Modify the two-way ANOVA model. Should the interaction be included in the final model for the present study? Why/Why not?</li>
<li>Toughness is explained by muscle fibers and connective tissue. The contribution from muscle fibers is impacted by suspension method. The contribution from connective tissue is impacted by age. Would you expect an effect of the interaction term between suspension method and age? Why/Why not? How does your answer correspond with the answers in question 6?</li>
<li>Traditionally, carcasses suspension is done by Achilles, what would you recommend based on this study? What are the limitations/assumptions for such a recommendation?
<ul>
<li>Hint: Have we checked all muscles? Look at the picture - do you think the conclusions extrapolate to other parts of the animal?</li>
</ul></li>
</ol>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<!-- End exercise callout -->
<div class="callout callout-style-default callout-exercise no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-19-contents" aria-controls="callout-19" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise 16.7 - Stability of oil under different conditions
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-19" class="callout-19-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<div id="ex-stability-of-oil-2" class="callout-exercise">
<p>This exercise is a direct extension of <span class="citation" data-cites="ex-stability-of-oil-under-different-conditions">(<a href="#ref-ex-stability-of-oil-under-different-conditions" role="doc-biblioref"><strong>ex-stability-of-oil-under-different-conditions?</strong></a>)</span>.</p>
<p>Oil are primary made up of triglycerides, where some of the fatty acids are unsaturated. This causes such a product to be susceptible to oxidation both from chemical oxidative agents such as metal ions, or from exposure to light. Oxidation of the unsaturated fatty acids changes the sensorical and physical properties of the oil.</p>
<p>In the southern part of Africa grows a robust bean - the Marama bean. This bean has a favorable dietary composition, including dietary fibers, fats and proteins, as most similar types of nuts, therefore this crop could be utilized for making healthy products by the locals for the locals. One such product is Marama bean oil. A study has been conducted to investigate the oxidative stability of the oil under various conditions. In the dataset <code>MaramaBeanOilOx.xlsx</code> are listed the results from such an experiment (including data from both normal and roasted beans). The experimental factors are:</p>
<ul>
<li>Storage time (<code>Month</code>)</li>
<li>Product type (<code>Product</code>)</li>
<li>Storage temperature (<code>Temperature</code>)</li>
<li>Storage condition (<code>Light</code>)</li>
<li>Packaging air (<code>Air</code>)</li>
</ul>
<p>The response variable reflecting oxidative stability is peroxide value and named <code>PV</code>.</p>
<p>The first three questions are identical to <span class="citation" data-cites="ex-stability-of-oil-under-different-conditions">(<a href="#ref-ex-stability-of-oil-under-different-conditions" role="doc-biblioref"><strong>ex-stability-of-oil-under-different-conditions?</strong></a>)</span>.</p>
<div class="callout callout-style-default callout-task no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-18-contents" aria-controls="callout-18" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tasks
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-18" class="callout-18-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<div class="callout-task">
<ol type="1">
<li>Read in the data, and subset so that you only include data related to product type <code>Oil</code>.</li>
<li>Make descriptive plots of the response variable <code>PV</code> imposing storage temperature, condition, and time.
<ul>
<li>Hint: <code>factor(Temperature):Light</code> specifies all combinations of these two factors. <code>facet_grid(.~Month)</code> splits the plot into several plots according to Month.</li>
</ul></li>
<li>What do you observe in terms of storage time, temperature and condition from this plot?</li>
<li>Based on the plot, suggest a model including the three factors <code>Month</code>, <code>Temperature</code> and <code>Light</code>. Which factors do you think is additive (i.e.&nbsp;have the same effect regardless of the other factors), and which do you think interacts?</li>
<li>Build a model including all combinations of the three factors.
<ul>
<li>That is: <code>m &lt;- aov(data=Marama.oil, PV~factor(Temperature)*Light*factor(Month))</code>.</li>
</ul></li>
<li>Check the assumption concerning the distribution of the residuals. If necessary, make an appropriate transformation of the response variable, and check that it is doing better in terms of distributional assumptions for the model residuals.</li>
<li>It seems like we need all combinations of everything. Construct a single variable, that has the seven levels indicating the design, and use this in an ANOVA model.
<ul>
<li>Hint: <code>Allcomp &lt;- factor(Marama.oil$Temperature):Marama.oil$Light:factor(Marama.oil$Month</code></li>
</ul></li>
<li>Use <code>TukeyHSD()</code> on that model to make all pairwise comparisons of the seven individual levels. And comment on what you obtain. Does the initial plot correspond to the pairwise observations?</li>
</ol>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<!-- End exercise callout -->


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
          // default icon
          link.classList.add("external");
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../chapters/week6/model_formulation.html" class="pagination-link" aria-label="Model formulation">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Model formulation</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../chapters/week7/week_7.html" class="pagination-link" aria-label="Week 7">
        <span class="nav-page-text">Week 7</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb14" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># Analysis of Variance (ANOVA)</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: anova-setup</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip}</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a><span class="fu">## Learning objectives</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>The learning objectives for this theme is to understand the statistical comparison of means from e.g. several</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>different treatments. That is:</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>ANOVA is based on separation of the total variance in the data.</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>The inferential test is relating the systematic variance with the random variance.</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>To grasp, that the ratio of variances can be tested in a F-distribution.</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Be able to compare responses to several ”treatments”, by model specification, hypothesis formulation and testing.</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Be able to validate model assumptions.</span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>To understand the relation between t-test and one-way ANOVA, and use a one-way ANOVA model to do pairwise comparisons between treatment 1 and treatment 2, treatment 1 and treatment 3, and so forth.</span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>To be able to compute anova with one or two factors.</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>In short, ANOVA can be seen as an extention of the t-test. One-way ANOVA is for two sample t-test with more than two samples. And two-way anova is for paired t-test where there are more than just a pair.</span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a><span class="fu">## Intro to ANOVA</span></span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a><span class="fu">### Model formulation</span></span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>Depending on the notes, there are several ways to write up the data for an ANOVA model. The following three versions are exactly similar for a setup with $k$ groups, and possibly not equal number of observations within each group. <span class="sc">\\</span></span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a>Version 1:</span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a>X_{11},X_{12},X_{13},...,X_{1n_1} &amp;\sim \mathcal{N}(\mu_1,\sigma^2) <span class="sc">\\</span></span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a>X_{21},X_{22},X_{23},...,X_{2n_2} &amp;\sim \mathcal{N}(\mu_2,\sigma^2) <span class="sc">\\</span></span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a>&amp; \vdots <span class="sc">\\</span></span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a>X_{k1},X_{k2},X_{k3},...,X_{kn_k} &amp;\sim \mathcal{N}(\mu_k,\sigma^2) </span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-47"><a href="#cb14-47" aria-hidden="true" tabindex="-1"></a>Version 2:</span>
<span id="cb14-48"><a href="#cb14-48" aria-hidden="true" tabindex="-1"></a>\begin{gather}</span>
<span id="cb14-49"><a href="#cb14-49" aria-hidden="true" tabindex="-1"></a>X_{ij}\sim  \mathcal{N}(\mu_i,\sigma^2)<span class="sc">\\</span></span>
<span id="cb14-50"><a href="#cb14-50" aria-hidden="true" tabindex="-1"></a>\text{for } j=1,...,n_i \text{ and } i=1,..,k \nonumber</span>
<span id="cb14-51"><a href="#cb14-51" aria-hidden="true" tabindex="-1"></a>\end{gather}</span>
<span id="cb14-52"><a href="#cb14-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-53"><a href="#cb14-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-54"><a href="#cb14-54" aria-hidden="true" tabindex="-1"></a>Version 3:</span>
<span id="cb14-55"><a href="#cb14-55" aria-hidden="true" tabindex="-1"></a>\begin{gather}</span>
<span id="cb14-56"><a href="#cb14-56" aria-hidden="true" tabindex="-1"></a>X_{ij} = \mu_i + e_{ij} \nonumber <span class="sc">\\</span></span>
<span id="cb14-57"><a href="#cb14-57" aria-hidden="true" tabindex="-1"></a>\text{where } e_{ij}\sim \mathcal{N}(0,\sigma^2) \text{ and  independent} <span class="sc">\\</span></span>
<span id="cb14-58"><a href="#cb14-58" aria-hidden="true" tabindex="-1"></a>\text{for } j=1,...,n_i \text {and } i=1,..,k \nonumber</span>
<span id="cb14-59"><a href="#cb14-59" aria-hidden="true" tabindex="-1"></a>\end{gather}</span>
<span id="cb14-60"><a href="#cb14-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-61"><a href="#cb14-61" aria-hidden="true" tabindex="-1"></a>For all three versions, the parameters describing the groups ($\mu_i$ for $i=1,..,k$) and the dispersion within the groups ($\sigma$) appear, and are exactly similar. Naturally, all three versions are correct, but in order to harmonize with notation for ANOVA with several factors and regression we stick with version 3.</span>
<span id="cb14-62"><a href="#cb14-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-63"><a href="#cb14-63" aria-hidden="true" tabindex="-1"></a>For these models it is assumed that the residuals are coming from the *same* normal distribution. That is: $e_{ij}\sim \mathcal{N}(0,\sigma^2)$. By construction, this distribution has mean equal to zero. Further it is assumed that these residuals are independent, that is: Changing one will not affect the others. If these two assumptions (same distribution and independent) are not fulfilled, the model is not valid, and we cannot trust the tests. Therefor this is checked by visual inspection of the residuals for normality (qq-plot, histogram, residuals vs. predicted value etc.) and independence (residuals vs. predicted value, line-plotting). As this is a very inherent part of model validation, it is made easy in R, where <span class="in">`plot()`</span> on the object created by <span class="in">`aov()`</span> or <span class="in">`lm()`</span> produces graphics which can be used directly; fast'n'easy. </span>
<span id="cb14-64"><a href="#cb14-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-65"><a href="#cb14-65" aria-hidden="true" tabindex="-1"></a><span class="fu">### Hypothesis</span></span>
<span id="cb14-66"><a href="#cb14-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-67"><a href="#cb14-67" aria-hidden="true" tabindex="-1"></a>$\mu_1,..,\mu_k$ describes the center of each of the $1,..,k$ samples, and is naturally what is interesting to compare. Usually we are looking for differences between these means, why the null hypothesis is:</span>
<span id="cb14-68"><a href="#cb14-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-69"><a href="#cb14-69" aria-hidden="true" tabindex="-1"></a>\begin{equation}</span>
<span id="cb14-70"><a href="#cb14-70" aria-hidden="true" tabindex="-1"></a>H0: \mu_1 = \mu_2 = ... =  \mu_k</span>
<span id="cb14-71"><a href="#cb14-71" aria-hidden="true" tabindex="-1"></a>\end{equation}</span>
<span id="cb14-72"><a href="#cb14-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-73"><a href="#cb14-73" aria-hidden="true" tabindex="-1"></a>with the alternative, that at least one group \textit{sticks out}.</span>
<span id="cb14-74"><a href="#cb14-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-75"><a href="#cb14-75" aria-hidden="true" tabindex="-1"></a><span class="fu">### ANOVA table and test</span></span>
<span id="cb14-76"><a href="#cb14-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-77"><a href="#cb14-77" aria-hidden="true" tabindex="-1"></a>If we have two groups, the natural choice would be to use the differences between the observed means. However, for $k$ groups there are $k(k-1)/2$ combinations, why this approach would not lead to a single test, but merely $k(k-1)/2$ comparisons.</span>
<span id="cb14-78"><a href="#cb14-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-79"><a href="#cb14-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-80"><a href="#cb14-80" aria-hidden="true" tabindex="-1"></a>As an alternative for the differences between the observed means $\bar{X}_1,...,\bar{X}_k$, the variance across these numbers are used (only totally true for groups of equal size), that is: $MS_{bewteen} = var(\bar{X}_1,...,\bar{X}_k)$.  If there is large differences between the group means, then this measure $MS_{bewteen}$ is big, and the null hypothesis should be discarded. Formalized, this needs to be compared to the variance within the groups, that is the average spread around the points.</span>
<span id="cb14-81"><a href="#cb14-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-82"><a href="#cb14-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-83"><a href="#cb14-83" aria-hidden="true" tabindex="-1"></a>It turns out, that this process can be seen as a partitioning (splitting) of the total variance in the entire dataset into </span>
<span id="cb14-84"><a href="#cb14-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-85"><a href="#cb14-85" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>how much can be ascribed to the fact that samples are from different groups, and  </span>
<span id="cb14-86"><a href="#cb14-86" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>how much which is caused by natural variation within the groups. </span>
<span id="cb14-87"><a href="#cb14-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-88"><a href="#cb14-88" aria-hidden="true" tabindex="-1"></a>A natural way to organize these variances is in an ANOVA table. That is a table including the Sum of Squares (SSQ), Degrees of Freedom (DF), Mean Square (MS), observed F-statistic ($F_{obs}$  ), and $p$-value for each F-statistic $Pr(F_{df_A,df_e}&gt;F_{obs})$. @tbl-one-way-anova corresponds to a one-way ANOVA table (an analysis with one factor).</span>
<span id="cb14-89"><a href="#cb14-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-90"><a href="#cb14-90" aria-hidden="true" tabindex="-1"></a>| Source     | SSQ | DF | MS| $F_{obs}$         | $Pr(F_{df_A,df_e}&gt;F_{obs})$ |</span>
<span id="cb14-91"><a href="#cb14-91" aria-hidden="true" tabindex="-1"></a>|------------|----------|------------------|---------------------|-------------------|----------------------------|</span>
<span id="cb14-92"><a href="#cb14-92" aria-hidden="true" tabindex="-1"></a>| Factor(A)  | $SS_A$   | $df_A = k-1$    | $MS_A = SS_A/df_A$ | $F_A = MS_A/MS_e$ | $p_A$                      |</span>
<span id="cb14-93"><a href="#cb14-93" aria-hidden="true" tabindex="-1"></a>| Residuals  | $SS_e$   | $df_e = n-k$    | $MS_e = SS_e/df_e$ |                   |                            |</span>
<span id="cb14-94"><a href="#cb14-94" aria-hidden="true" tabindex="-1"></a>| Total      | $SS_{tot}$ | $df_{tot} = n-1$ |                   |                   |                            |</span>
<span id="cb14-95"><a href="#cb14-95" aria-hidden="true" tabindex="-1"></a>: ANOVA table for one-way analysis of variance. {#tbl-one-way-anova .table-sm}</span>
<span id="cb14-96"><a href="#cb14-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-97"><a href="#cb14-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-98"><a href="#cb14-98" aria-hidden="true" tabindex="-1"></a>Here the total variance is described as the sums of squares across all samples </span>
<span id="cb14-99"><a href="#cb14-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-100"><a href="#cb14-100" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb14-101"><a href="#cb14-101" aria-hidden="true" tabindex="-1"></a>SS_{tot} = \sum{(X_{ij} - \bar{\bar{X}})^2} \quad \text{for all} \quad j=1,...,n_i, \text{ and } i = 1,..,k,</span>
<span id="cb14-102"><a href="#cb14-102" aria-hidden="true" tabindex="-1"></a>$$ </span>
<span id="cb14-103"><a href="#cb14-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-104"><a href="#cb14-104" aria-hidden="true" tabindex="-1"></a>where $\bar{\bar{X}}$ is the overall average and $X_{ij}$ is the individual observations. </span>
<span id="cb14-105"><a href="#cb14-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-106"><a href="#cb14-106" aria-hidden="true" tabindex="-1"></a>In the columns *Sum of squares*  and *Degrees of freedom*, is the sum of the elements.</span>
<span id="cb14-107"><a href="#cb14-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-108"><a href="#cb14-108" aria-hidden="true" tabindex="-1"></a>In the two sample t-test we use the pooled variance $s_{X_{pooled}}^2$, In ANOVA this number is reflected by the residual variation $MS_e$, which is also the estimate of $\sigma^2$ (I.e. $\hat{\sigma}^2 = MS_e$).</span>
<span id="cb14-109"><a href="#cb14-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-110"><a href="#cb14-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-111"><a href="#cb14-111" aria-hidden="true" tabindex="-1"></a><span class="fu">### ANOVA with several factors</span></span>
<span id="cb14-112"><a href="#cb14-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-113"><a href="#cb14-113" aria-hidden="true" tabindex="-1"></a>Experiments often consist of several factors. For instance Coffee served at different *Temperatures* evaluated by different *Judges*, beer produced from different *Hops* and different *Yeast cultures* or oil stored at different *Temperature*, over *Time*, at different *Oxygen levels* and different *Light conditions*.</span>
<span id="cb14-114"><a href="#cb14-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-115"><a href="#cb14-115" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Model  </span></span>
<span id="cb14-116"><a href="#cb14-116" aria-hidden="true" tabindex="-1"></a>Imagine an experiment with two factors: $A$ and $B$, where $A$ has two levels, and $B$ has three levels, then the model is simply an extension of the one-way model: </span>
<span id="cb14-117"><a href="#cb14-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-118"><a href="#cb14-118" aria-hidden="true" tabindex="-1"></a>\begin{gather}</span>
<span id="cb14-119"><a href="#cb14-119" aria-hidden="true" tabindex="-1"></a>X_{i} = \alpha(A_i) + \beta(B_i) + e_{i} \nonumber <span class="sc">\\</span></span>
<span id="cb14-120"><a href="#cb14-120" aria-hidden="true" tabindex="-1"></a>\text{where } e_{i}\sim \mathcal{N}(0,\sigma^2) \text{ and independent} <span class="sc">\\</span></span>
<span id="cb14-121"><a href="#cb14-121" aria-hidden="true" tabindex="-1"></a>\text{for } i=1,...,n \nonumber</span>
<span id="cb14-122"><a href="#cb14-122" aria-hidden="true" tabindex="-1"></a>\end{gather}</span>
<span id="cb14-123"><a href="#cb14-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-124"><a href="#cb14-124" aria-hidden="true" tabindex="-1"></a>In this equation, $\alpha()$ describes the level with respect to $A$, and has two levels: $\alpha(A=1)$ and $\alpha(A=2)$, and $\beta()$ describes the level with respect to $B$, and has three levels: $\beta(B=1)$, $\beta(B=2)$ and $\beta(B=3)$.</span>
<span id="cb14-125"><a href="#cb14-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-126"><a href="#cb14-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-127"><a href="#cb14-127" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Hypotheses</span></span>
<span id="cb14-128"><a href="#cb14-128" aria-hidden="true" tabindex="-1"></a>The associated null hypothesis are:</span>
<span id="cb14-129"><a href="#cb14-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-130"><a href="#cb14-130" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Factor A: $H0: \alpha(A=1) = \alpha(A=2)= .... = \alpha(A=k_A)$</span>
<span id="cb14-131"><a href="#cb14-131" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Factor B: $H0: \beta(B=1) = \beta(B=2)= .... = \beta(B=k_B)$</span>
<span id="cb14-132"><a href="#cb14-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-133"><a href="#cb14-133" aria-hidden="true" tabindex="-1"></a><span class="fu">#### ANOVA table</span></span>
<span id="cb14-134"><a href="#cb14-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-135"><a href="#cb14-135" aria-hidden="true" tabindex="-1"></a>In the test of these hypothesis, the ANOVA table is simply extend with rows in relation to these effects @tbl-two-way-anova.</span>
<span id="cb14-136"><a href="#cb14-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-137"><a href="#cb14-137" aria-hidden="true" tabindex="-1"></a>| Source     | SSQ      | DF   | MS        | $F_{obs}$ | $Pr(F_{df_{Source},df_e}&gt;F_{obs})$ |</span>
<span id="cb14-138"><a href="#cb14-138" aria-hidden="true" tabindex="-1"></a>|------------|----------|------|-----------|------------|-----------------------------------|</span>
<span id="cb14-139"><a href="#cb14-139" aria-hidden="true" tabindex="-1"></a>| Factor(A)  | $SS_A$   | $df_A = k_A-1$ | $MS_A = SS_A/df_A$ | $F_A = MS_A/MS_e$ | $p_A$ |</span>
<span id="cb14-140"><a href="#cb14-140" aria-hidden="true" tabindex="-1"></a>| Factor(B)  | $SS_B$   | $df_B = k_B-1$ | $MS_B = SS_B/df_B$ | $F_B = MS_B/MS_e$ | $p_B$ |</span>
<span id="cb14-141"><a href="#cb14-141" aria-hidden="true" tabindex="-1"></a>| Residuals  | $SS_e$   | $df_e = n-df_A - df_B - 1$ | $MS_e = SS_e/df_e$ | |  |</span>
<span id="cb14-142"><a href="#cb14-142" aria-hidden="true" tabindex="-1"></a>| Total      | $SS_{tot}$ | $df_{tot} = n-1$ | | | |</span>
<span id="cb14-143"><a href="#cb14-143" aria-hidden="true" tabindex="-1"></a>: ANOVA table for a two-way ANOVA. {#tbl-two-way-anova .table-sm}</span>
<span id="cb14-144"><a href="#cb14-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-145"><a href="#cb14-145" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Interactions</span></span>
<span id="cb14-146"><a href="#cb14-146" aria-hidden="true" tabindex="-1"></a>For some experiments the effect of one factor might be dependent on the other factor, that is referred to as *interaction*. The interaction model for a two factor experiment is written as:</span>
<span id="cb14-147"><a href="#cb14-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-148"><a href="#cb14-148" aria-hidden="true" tabindex="-1"></a>\begin{gather}</span>
<span id="cb14-149"><a href="#cb14-149" aria-hidden="true" tabindex="-1"></a>X_{i} = \alpha(A_i) + \beta(B_i) + \gamma(A_i,B_i) +  e_{i} \nonumber <span class="sc">\\</span></span>
<span id="cb14-150"><a href="#cb14-150" aria-hidden="true" tabindex="-1"></a>\text{where } e_{i}\sim \mathcal{N}(0,\sigma^2) \text{ and independent} <span class="sc">\\</span></span>
<span id="cb14-151"><a href="#cb14-151" aria-hidden="true" tabindex="-1"></a>\text{for } j=1,...,n \nonumber </span>
<span id="cb14-152"><a href="#cb14-152" aria-hidden="true" tabindex="-1"></a>\end{gather}</span>
<span id="cb14-153"><a href="#cb14-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-154"><a href="#cb14-154" aria-hidden="true" tabindex="-1"></a>where $\gamma()$ describes the interaction between the two factor. In a model with e.g. $2$ and $3$ levels for the factors, this interaction term naturally has $2\cdot 3 = 6$ levels. However, in the model above, the main effects ($\alpha$ and $\beta$) are included, so that consumes some of the levels. Actually, this factor has $(k_A - 1)(k_B - 1)$ levels.</span>
<span id="cb14-155"><a href="#cb14-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-156"><a href="#cb14-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-157"><a href="#cb14-157" aria-hidden="true" tabindex="-1"></a><span class="fu">#### ANOVA table - interactions</span></span>
<span id="cb14-158"><a href="#cb14-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-159"><a href="#cb14-159" aria-hidden="true" tabindex="-1"></a>Testing the interaction leads to an extension of the ANOVA table, as seen in @tbl-two-way-anova-interaction.</span>
<span id="cb14-160"><a href="#cb14-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-161"><a href="#cb14-161" aria-hidden="true" tabindex="-1"></a>| Source     | SSQ      | DF   | MS        | $F_{obs}$ | $Pr(F_{df_{Source},df_e}&gt;F_{obs})$ |</span>
<span id="cb14-162"><a href="#cb14-162" aria-hidden="true" tabindex="-1"></a>|-------------|-----------|------------------------------------------------------------------|--------------------------|------------------------|-----------------------------------|</span>
<span id="cb14-163"><a href="#cb14-163" aria-hidden="true" tabindex="-1"></a>| Factor(A)   | $SS_A$    | $df_A = k_A-1$                                                   | $MS_A = SS_A/df_A$       | $F_A = MS_A/MS_e$      | $p_A$                             |</span>
<span id="cb14-164"><a href="#cb14-164" aria-hidden="true" tabindex="-1"></a>| Factor(B)   | $SS_B$    | $df_B = k_B-1$                                                   | $MS_B = SS_B/df_B$       | $F_B = MS_B/MS_e$      | $p_B$                             |</span>
<span id="cb14-165"><a href="#cb14-165" aria-hidden="true" tabindex="-1"></a>| Factor(A*B) | $SS_{AB}$ | $df_{AB} = (k_A-1)(k_B-1)$                                      | $MS_{AB} = SS_{AB}/df_{AB}$ | $F_{AB} = MS_{AB}/MS_e$ | $p_{AB}$                          |</span>
<span id="cb14-166"><a href="#cb14-166" aria-hidden="true" tabindex="-1"></a>| Residuals   | $SS_e$    | $df_e = n-df_A - df_B - df_{AB} - 1 = n - (k_A)(k_B)$          | $MS_e = SS_e/df_e$       |                        |                                   |</span>
<span id="cb14-167"><a href="#cb14-167" aria-hidden="true" tabindex="-1"></a>| Total       | $SS_{tot}$ | $df_{tot} = n-1$                                                |                          |                        |                                   |</span>
<span id="cb14-168"><a href="#cb14-168" aria-hidden="true" tabindex="-1"></a>: ANOVA table for a two-way ANOVA with interaction. {#tbl-two-way-anova-interaction .table-sm}</span>
<span id="cb14-169"><a href="#cb14-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-170"><a href="#cb14-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-171"><a href="#cb14-171" aria-hidden="true" tabindex="-1"></a>We see that the only thing that changes is the sums of squares and the degrees of freedom for the residuals. </span>
<span id="cb14-172"><a href="#cb14-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-173"><a href="#cb14-173" aria-hidden="true" tabindex="-1"></a>::: {.callout-example #exa-natural-phenolic-antiox-anova}</span>
<span id="cb14-174"><a href="#cb14-174" aria-hidden="true" tabindex="-1"></a><span class="fu">### Natural phenolic antioxidants for meat preservation - ANOVA</span></span>
<span id="cb14-175"><a href="#cb14-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-178"><a href="#cb14-178" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb14-179"><a href="#cb14-179" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: anova-example-setup</span></span>
<span id="cb14-180"><a href="#cb14-180" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb14-181"><a href="#cb14-181" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb14-182"><a href="#cb14-182" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb14-183"><a href="#cb14-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-184"><a href="#cb14-184" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"meat_data.RData"</span>))</span>
<span id="cb14-185"><a href="#cb14-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-186"><a href="#cb14-186" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb14-187"><a href="#cb14-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-188"><a href="#cb14-188" aria-hidden="true" tabindex="-1"></a>This example is based on the sensory data on the meat sausages treated with green tea (GT) and rosemary extract (RE) or control, used previously in example @#exa-natural-phenolic-antiox-paired-t-test.</span>
<span id="cb14-189"><a href="#cb14-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-190"><a href="#cb14-190" aria-hidden="true" tabindex="-1"></a>A two-way anova can be used to evaluate the effect of several factors, and possible interaction effects on a single response variable. Here, we define a model with systematic effects of *Treatment* (3 levels), *Assessor* (8 levels) and *Week* (2 levels). Since it may be that the effect of the storage time differs for each of the antioxidant treatments, an interaciton effect between *Treatment* and *Week* is also included.</span>
<span id="cb14-191"><a href="#cb14-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-192"><a href="#cb14-192" aria-hidden="true" tabindex="-1"></a>The starting model is therefore formulated as:</span>
<span id="cb14-193"><a href="#cb14-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-194"><a href="#cb14-194" aria-hidden="true" tabindex="-1"></a>\begin{equation}</span>
<span id="cb14-195"><a href="#cb14-195" aria-hidden="true" tabindex="-1"></a>Y_i=\alpha (Treat_i)+\beta(Assessor_i)+\gamma(Week_i)+\theta(Treat_i\times Week_i)+e_i</span>
<span id="cb14-196"><a href="#cb14-196" aria-hidden="true" tabindex="-1"></a>\end{equation}</span>
<span id="cb14-197"><a href="#cb14-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-198"><a href="#cb14-198" aria-hidden="true" tabindex="-1"></a>where $e_i \sim \mathcal{N}(0,\sigma ^2)$ and independent for $i=1,\ldots,n$</span>
<span id="cb14-199"><a href="#cb14-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-200"><a href="#cb14-200" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Plot the data</span></span>
<span id="cb14-201"><a href="#cb14-201" aria-hidden="true" tabindex="-1"></a>We wish to visualize three factors on a single response variable (@fig-smell-old-vs-treatment). Here we use the x-axis for *Week* and *Treatment*, whereas the points are connected within *Assessor*.</span>
<span id="cb14-202"><a href="#cb14-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-205"><a href="#cb14-205" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb14-206"><a href="#cb14-206" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-smell-old-vs-treatment</span></span>
<span id="cb14-207"><a href="#cb14-207" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: Feedback on *Smell_Old* for all judges as a function of treatment. The plot is divided into week 0 and week 4. </span></span>
<span id="cb14-208"><a href="#cb14-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-209"><a href="#cb14-209" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(X, <span class="fu">aes</span>(Treatment, Smell_Old, <span class="at">group =</span> Assessor)) <span class="sc">+</span></span>
<span id="cb14-210"><a href="#cb14-210" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">5</span>, <span class="fu">aes</span>(<span class="at">color =</span> week)) <span class="sc">+</span></span>
<span id="cb14-211"><a href="#cb14-211" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb14-212"><a href="#cb14-212" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>week) <span class="sc">+</span></span>
<span id="cb14-213"><a href="#cb14-213" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb14-214"><a href="#cb14-214" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> X[X<span class="sc">$</span>Treatment <span class="sc">==</span> <span class="st">"Control"</span>, ],</span>
<span id="cb14-215"><a href="#cb14-215" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> Assessor), </span>
<span id="cb14-216"><a href="#cb14-216" aria-hidden="true" tabindex="-1"></a>    <span class="at">hjust =</span> <span class="fl">1.5</span> <span class="co"># Move the labels a little to the left</span></span>
<span id="cb14-217"><a href="#cb14-217" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb14-218"><a href="#cb14-218" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb14-219"><a href="#cb14-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-220"><a href="#cb14-220" aria-hidden="true" tabindex="-1"></a>From the figure there are a few observations: First, some assessors (e.g.~128 and 197) use the entire range whereas some only scores in a narrow range (e.g.~12, 193 and 187). Generally it seems as the control treatment (at both time points) obtain higher scores compared to the treated samples. There are no apparent indications for the two treatments being different.</span>
<span id="cb14-221"><a href="#cb14-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-222"><a href="#cb14-222" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Calculate two-way ANOVA</span></span>
<span id="cb14-223"><a href="#cb14-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-224"><a href="#cb14-224" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb14-225"><a href="#cb14-225" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Using base R</span></span>
<span id="cb14-228"><a href="#cb14-228" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb14-229"><a href="#cb14-229" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute ANOVA using specified model:</span></span>
<span id="cb14-230"><a href="#cb14-230" aria-hidden="true" tabindex="-1"></a><span class="co"># Smell_Old = Assessor + Treatment + Week + Treatment * Week</span></span>
<span id="cb14-231"><a href="#cb14-231" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">aov</span>(Smell_Old <span class="sc">~</span> <span class="fu">factor</span>(Assessor) <span class="sc">+</span> <span class="fu">factor</span>(Treatment) <span class="sc">*</span> <span class="fu">factor</span>(week),</span>
<span id="cb14-232"><a href="#cb14-232" aria-hidden="true" tabindex="-1"></a>           <span class="at">data =</span> X)</span>
<span id="cb14-233"><a href="#cb14-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-234"><a href="#cb14-234" aria-hidden="true" tabindex="-1"></a><span class="co"># Show ANOVA table</span></span>
<span id="cb14-235"><a href="#cb14-235" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit)</span>
<span id="cb14-236"><a href="#cb14-236" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb14-237"><a href="#cb14-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-238"><a href="#cb14-238" aria-hidden="true" tabindex="-1"></a>Important! The <span class="in">`factor()`</span> calls are important as they convert the variables from numeric/strings to factors. What happens if you remove <span class="in">`factor()`</span>?</span>
<span id="cb14-239"><a href="#cb14-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-240"><a href="#cb14-240" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Using Tidyverse</span></span>
<span id="cb14-243"><a href="#cb14-243" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb14-244"><a href="#cb14-244" aria-hidden="true" tabindex="-1"></a><span class="co"># Turn column "Assessor", "Treatment" and "week" into factors</span></span>
<span id="cb14-245"><a href="#cb14-245" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> X <span class="sc">|&gt;</span> </span>
<span id="cb14-246"><a href="#cb14-246" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(Assessor, Treatment, week), factor))</span>
<span id="cb14-247"><a href="#cb14-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-248"><a href="#cb14-248" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute ANOVA using specified model:</span></span>
<span id="cb14-249"><a href="#cb14-249" aria-hidden="true" tabindex="-1"></a><span class="co"># Smell_Old = Assessor + Treatment + Week + Treatment * Week</span></span>
<span id="cb14-250"><a href="#cb14-250" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">aov</span>(Smell_Old <span class="sc">~</span> Assessor <span class="sc">+</span> Treatment <span class="sc">*</span> week,</span>
<span id="cb14-251"><a href="#cb14-251" aria-hidden="true" tabindex="-1"></a>           <span class="at">data =</span> X)</span>
<span id="cb14-252"><a href="#cb14-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-253"><a href="#cb14-253" aria-hidden="true" tabindex="-1"></a><span class="co"># Show ANOVA table</span></span>
<span id="cb14-254"><a href="#cb14-254" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit)          </span>
<span id="cb14-255"><a href="#cb14-255" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb14-256"><a href="#cb14-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-257"><a href="#cb14-257" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb14-258"><a href="#cb14-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-259"><a href="#cb14-259" aria-hidden="true" tabindex="-1"></a>Here it can be seen that the only effect which is found significant ($p &lt; 0.05$) for the *Old_Smell* response is the *Treatment* factor. No significance was found for the *Week* or interaction factors. The *Assessor* effect is not strictly signifcant, but on the borderline ($p=0.09$). If we plot the raw data (@fig-smell-old-vs-treatment), it seems each of the assesors have different base levels of scoring the old smell descriptor. Therefore, it is chosen to keep the systematic effect of *Assessor* in the model. Furthermore, it can be seen that there is some variation in the *Assessor* evaluation of the treatment effect (non-parallel), indicating that the sensory panel is not very precise, and may be poorly trained.</span>
<span id="cb14-260"><a href="#cb14-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-261"><a href="#cb14-261" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Final model</span></span>
<span id="cb14-262"><a href="#cb14-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-263"><a href="#cb14-263" aria-hidden="true" tabindex="-1"></a>The final model is therefore the model only including the effects of the treatment and *Assessor* factors: </span>
<span id="cb14-264"><a href="#cb14-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-265"><a href="#cb14-265" aria-hidden="true" tabindex="-1"></a>\begin{equation}</span>
<span id="cb14-266"><a href="#cb14-266" aria-hidden="true" tabindex="-1"></a>Y_i=\alpha (Treat_i)+\beta(Assessor_i)+e_i </span>
<span id="cb14-267"><a href="#cb14-267" aria-hidden="true" tabindex="-1"></a>\end{equation}</span>
<span id="cb14-268"><a href="#cb14-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-269"><a href="#cb14-269" aria-hidden="true" tabindex="-1"></a>where $e_i \sim \mathcal{N}(0,\sigma^2)$ and independent for $i=1,\ldots,n$.</span>
<span id="cb14-270"><a href="#cb14-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-271"><a href="#cb14-271" aria-hidden="true" tabindex="-1"></a>The estimates for the factors ($\alpha(Control),\alpha(GT), \alpha(RE), \beta(Ass12),\ldots,\beta(193)$) as well as the standard deviation ($\hat{\sigma}$) can be obtained by first calculating a new model including only significant terms followed by the *anova()* and *summary()* commands. </span>
<span id="cb14-272"><a href="#cb14-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-273"><a href="#cb14-273" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb14-274"><a href="#cb14-274" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- End example callout --&gt;</span></span>
<span id="cb14-275"><a href="#cb14-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-276"><a href="#cb14-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-277"><a href="#cb14-277" aria-hidden="true" tabindex="-1"></a><span class="fu">### Contrasts</span></span>
<span id="cb14-278"><a href="#cb14-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-279"><a href="#cb14-279" aria-hidden="true" tabindex="-1"></a>If it turns out that there is a significant effect of the factor, a natural next step is to compare the individual levels by estimation of confidence intervals and/or testing differences. This is quite similar to comparing two means by t-test. The only difference is, that $\hat{\sigma}^2 = MS_e$ is used as the measure of random uncertainty (instead of $s_{X_{pooled}}^2$), and the degrees of freedom is NOT $n_1 + n_2 - 2$, but the degrees of freedom associated with the uncertainty estimate: $df_e$. Apart from that, the method is similar. </span>
<span id="cb14-280"><a href="#cb14-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-281"><a href="#cb14-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-282"><a href="#cb14-282" aria-hidden="true" tabindex="-1"></a>Assume that *Factor(A)* has five levels, then the comparison of e.g. level $2$ and $5$ is done as follows: </span>
<span id="cb14-283"><a href="#cb14-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-284"><a href="#cb14-284" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Confidence intervals</span></span>
<span id="cb14-285"><a href="#cb14-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-286"><a href="#cb14-286" aria-hidden="true" tabindex="-1"></a>\begin{equation}</span>
<span id="cb14-287"><a href="#cb14-287" aria-hidden="true" tabindex="-1"></a>\bar{X_5} - \bar{X_2} \pm t_{1 - \alpha/2,df_e}\sqrt{MS_e}\sqrt{\frac{1}{n_5} + \frac{1}{n_2}}</span>
<span id="cb14-288"><a href="#cb14-288" aria-hidden="true" tabindex="-1"></a>\end{equation}</span>
<span id="cb14-289"><a href="#cb14-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-290"><a href="#cb14-290" aria-hidden="true" tabindex="-1"></a>Where $t_{1 - \alpha/2,df_e}$ is the t-fractile at a user-specified level $\alpha$ with $df_e$ degrees of freedom.</span>
<span id="cb14-291"><a href="#cb14-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-292"><a href="#cb14-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-293"><a href="#cb14-293" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Test of contrast</span></span>
<span id="cb14-294"><a href="#cb14-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-295"><a href="#cb14-295" aria-hidden="true" tabindex="-1"></a>The associated hypothesis are stated as:</span>
<span id="cb14-296"><a href="#cb14-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-297"><a href="#cb14-297" aria-hidden="true" tabindex="-1"></a>\begin{equation}</span>
<span id="cb14-298"><a href="#cb14-298" aria-hidden="true" tabindex="-1"></a>H_0: \mu_5=\mu_2</span>
<span id="cb14-299"><a href="#cb14-299" aria-hidden="true" tabindex="-1"></a>\end{equation}</span>
<span id="cb14-300"><a href="#cb14-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-301"><a href="#cb14-301" aria-hidden="true" tabindex="-1"></a>With the alternative: </span>
<span id="cb14-302"><a href="#cb14-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-303"><a href="#cb14-303" aria-hidden="true" tabindex="-1"></a>\begin{equation}</span>
<span id="cb14-304"><a href="#cb14-304" aria-hidden="true" tabindex="-1"></a>H_A: \mu_5 \neq \mu_2</span>
<span id="cb14-305"><a href="#cb14-305" aria-hidden="true" tabindex="-1"></a>\end{equation}</span>
<span id="cb14-306"><a href="#cb14-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-307"><a href="#cb14-307" aria-hidden="true" tabindex="-1"></a>Then the test statistics is calculated as: </span>
<span id="cb14-308"><a href="#cb14-308" aria-hidden="true" tabindex="-1"></a>\begin{equation}</span>
<span id="cb14-309"><a href="#cb14-309" aria-hidden="true" tabindex="-1"></a>t_{obs} = \frac{\bar{X_5} - \bar{X_2}} {\sqrt{MS_e}\sqrt{\frac{1}{n_5} + \frac{1}{n_2}}}</span>
<span id="cb14-310"><a href="#cb14-310" aria-hidden="true" tabindex="-1"></a>\end{equation}</span>
<span id="cb14-311"><a href="#cb14-311" aria-hidden="true" tabindex="-1"></a>With the associated (2-sided) p-value: $p = 2 \cdot P(\mathcal{T}_{df=df_e}&gt;t_{obs})$. </span>
<span id="cb14-312"><a href="#cb14-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-313"><a href="#cb14-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-314"><a href="#cb14-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-315"><a href="#cb14-315" aria-hidden="true" tabindex="-1"></a>::: {.callout-example #exa-natual-phenolic-antiox-contrasts}</span>
<span id="cb14-316"><a href="#cb14-316" aria-hidden="true" tabindex="-1"></a><span class="fu">### Natural phenolic antioxidants for meat preservation - contrasts</span></span>
<span id="cb14-317"><a href="#cb14-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-318"><a href="#cb14-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-319"><a href="#cb14-319" aria-hidden="true" tabindex="-1"></a>In this example, we wish to compare pairs of levels within a factor from an ANOVA model. In @exa-natural-phenolic-antiox-anova the *Treatment* effect from a two way model as shown below is significant, however, that does not imply that all levels are different, but only that at least a single strikes out. </span>
<span id="cb14-320"><a href="#cb14-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-321"><a href="#cb14-321" aria-hidden="true" tabindex="-1"></a>We start by computing the ANOVA and assigning it to the variable <span class="in">`fit`</span>.</span>
<span id="cb14-322"><a href="#cb14-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-325"><a href="#cb14-325" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb14-326"><a href="#cb14-326" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute ANOVA</span></span>
<span id="cb14-327"><a href="#cb14-327" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">aov</span>(Smell_Old <span class="sc">~</span> <span class="fu">factor</span>(Assessor) <span class="sc">+</span> <span class="fu">factor</span>(Treatment),</span>
<span id="cb14-328"><a href="#cb14-328" aria-hidden="true" tabindex="-1"></a>           <span class="at">data =</span> X)</span>
<span id="cb14-329"><a href="#cb14-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-330"><a href="#cb14-330" aria-hidden="true" tabindex="-1"></a><span class="co"># Print ANOVA table</span></span>
<span id="cb14-331"><a href="#cb14-331" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit)</span>
<span id="cb14-332"><a href="#cb14-332" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb14-333"><a href="#cb14-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-334"><a href="#cb14-334" aria-hidden="true" tabindex="-1"></a>We can use <span class="in">`model.tables()`</span> to get means for each level of each factor. </span>
<span id="cb14-335"><a href="#cb14-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-338"><a href="#cb14-338" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb14-339"><a href="#cb14-339" aria-hidden="true" tabindex="-1"></a><span class="co"># Show means across both factors</span></span>
<span id="cb14-340"><a href="#cb14-340" aria-hidden="true" tabindex="-1"></a><span class="fu">model.tables</span>(fit, <span class="at">type =</span> <span class="st">"means"</span>)</span>
<span id="cb14-341"><a href="#cb14-341" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb14-342"><a href="#cb14-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-343"><a href="#cb14-343" aria-hidden="true" tabindex="-1"></a>The rows of numbers contain the means across each level. <span class="in">`rep`</span> is the number of observations.</span>
<span id="cb14-344"><a href="#cb14-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-345"><a href="#cb14-345" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Contrasts</span></span>
<span id="cb14-346"><a href="#cb14-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-347"><a href="#cb14-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-348"><a href="#cb14-348" aria-hidden="true" tabindex="-1"></a>We wish to compare the treatments *RE* and *GT*. This a basically a two sample t-test, just where the entire dataset and model is used to calculate the standard deviation.</span>
<span id="cb14-349"><a href="#cb14-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-350"><a href="#cb14-350" aria-hidden="true" tabindex="-1"></a>The hypothesis are: </span>
<span id="cb14-351"><a href="#cb14-351" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb14-352"><a href="#cb14-352" aria-hidden="true" tabindex="-1"></a>H_0: \mu_{GT}=\mu_{RE} \quad \text{and} \quad H_A: \mu_{GT} \neq \mu_{RE}</span>
<span id="cb14-353"><a href="#cb14-353" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb14-354"><a href="#cb14-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-355"><a href="#cb14-355" aria-hidden="true" tabindex="-1"></a>Naturally, the driver of this test is the observed difference between the two means. In total the test-statistics amount to: </span>
<span id="cb14-356"><a href="#cb14-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-357"><a href="#cb14-357" aria-hidden="true" tabindex="-1"></a>\begin{equation}</span>
<span id="cb14-358"><a href="#cb14-358" aria-hidden="true" tabindex="-1"></a>t_{obs} = \frac{\bar{X}_{GT} - \bar{X}_{RE}} {\sqrt{MS_e}\sqrt{\frac{1}{n_{GT}} + \frac{1}{n_{RE}}}}</span>
<span id="cb14-359"><a href="#cb14-359" aria-hidden="true" tabindex="-1"></a>\end{equation}</span>
<span id="cb14-360"><a href="#cb14-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-361"><a href="#cb14-361" aria-hidden="true" tabindex="-1"></a>With the associated (2-sided) p-value: </span>
<span id="cb14-362"><a href="#cb14-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-363"><a href="#cb14-363" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb14-364"><a href="#cb14-364" aria-hidden="true" tabindex="-1"></a>p = 2 \cdot P(\mathcal{T}_{df=df_e}&gt;t_{obs})</span>
<span id="cb14-365"><a href="#cb14-365" aria-hidden="true" tabindex="-1"></a>$$ </span>
<span id="cb14-366"><a href="#cb14-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-369"><a href="#cb14-369" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb14-370"><a href="#cb14-370" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fl">1.86</span> <span class="co"># GT mean</span></span>
<span id="cb14-371"><a href="#cb14-371" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fl">2.57</span> <span class="co"># RE mean</span></span>
<span id="cb14-372"><a href="#cb14-372" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="dv">16</span> <span class="co"># GT n</span></span>
<span id="cb14-373"><a href="#cb14-373" aria-hidden="true" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> <span class="dv">16</span> <span class="co"># RE n</span></span>
<span id="cb14-374"><a href="#cb14-374" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fl">5.325</span>) <span class="co"># SD from ANOVA table</span></span>
<span id="cb14-375"><a href="#cb14-375" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="dv">37</span> <span class="co"># DF for residuals</span></span>
<span id="cb14-376"><a href="#cb14-376" aria-hidden="true" tabindex="-1"></a>t_obs <span class="ot">&lt;-</span> (m1 <span class="sc">-</span> m2) <span class="sc">/</span> (s<span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">/</span>n1 <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span>n2)) <span class="co"># Test statistic</span></span>
<span id="cb14-377"><a href="#cb14-377" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pt</span>(<span class="fu">abs</span>(t_obs),df)) <span class="co"># p-value for GT vs RE</span></span>
<span id="cb14-378"><a href="#cb14-378" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb14-379"><a href="#cb14-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-380"><a href="#cb14-380" aria-hidden="true" tabindex="-1"></a>In line with the raw data, the observed difference between the two treatments, is not statistically singificant, and we conclude that the two treatments has similar properties in terms of *Old_Smell*. </span>
<span id="cb14-381"><a href="#cb14-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-382"><a href="#cb14-382" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Confidence interval on difference between RE and Control</span></span>
<span id="cb14-383"><a href="#cb14-383" aria-hidden="true" tabindex="-1"></a>As an alternative, the confidence interval on the difference between two means can be calculated. As example this is done for RE vs Control. </span>
<span id="cb14-384"><a href="#cb14-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-385"><a href="#cb14-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-388"><a href="#cb14-388" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb14-389"><a href="#cb14-389" aria-hidden="true" tabindex="-1"></a>m3 <span class="ot">&lt;-</span> <span class="fl">4.75</span> <span class="co"># Control mean</span></span>
<span id="cb14-390"><a href="#cb14-390" aria-hidden="true" tabindex="-1"></a>n3 <span class="ot">&lt;-</span> <span class="dv">15</span> <span class="co"># Control n</span></span>
<span id="cb14-391"><a href="#cb14-391" aria-hidden="true" tabindex="-1"></a>CIlow <span class="ot">&lt;-</span> m3 <span class="sc">-</span> m2 <span class="sc">-</span> <span class="fu">qt</span>(<span class="fl">0.975</span>,df)<span class="sc">*</span>s<span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">/</span>n2 <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span>n3) <span class="co"># lower bound</span></span>
<span id="cb14-392"><a href="#cb14-392" aria-hidden="true" tabindex="-1"></a>CIhigh <span class="ot">&lt;-</span> m3 <span class="sc">-</span> m2 <span class="sc">+</span> <span class="fu">qt</span>(<span class="fl">0.975</span>,df)<span class="sc">*</span>s<span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">/</span>n2 <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span>n3) <span class="co"># upper bound</span></span>
<span id="cb14-393"><a href="#cb14-393" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(CIlow,CIhigh)</span>
<span id="cb14-394"><a href="#cb14-394" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb14-395"><a href="#cb14-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-396"><a href="#cb14-396" aria-hidden="true" tabindex="-1"></a>We see that the confidence interval on the difference between the control and RE treated samples are positive and do not overlap $0$, that is, in general the control samples has a higher score with respect to *Old_Smell* and further that this is a significant difference on $95\%$ level. </span>
<span id="cb14-397"><a href="#cb14-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-398"><a href="#cb14-398" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb14-399"><a href="#cb14-399" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- End example callout --&gt;</span></span>
<span id="cb14-400"><a href="#cb14-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-401"><a href="#cb14-401" aria-hidden="true" tabindex="-1"></a><span class="fu">## Reading material</span></span>
<span id="cb14-402"><a href="#cb14-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-403"><a href="#cb14-403" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>A brief video going through the concepts of both one-way and two-way ANOVA:</span>
<span id="cb14-404"><a href="#cb14-404" aria-hidden="true" tabindex="-1"></a><span class="ss">    * </span><span class="co">[</span><span class="ot">Analysis of Variance (ANOVA)</span><span class="co">](#sec-anova-eisenberg)</span></span>
<span id="cb14-405"><a href="#cb14-405" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>A video going through how to do ANOVA in R:</span>
<span id="cb14-406"><a href="#cb14-406" aria-hidden="true" tabindex="-1"></a><span class="ss">    * </span><span class="co">[</span><span class="ot">ANOVA in R</span><span class="co">](#sec-anova-boone)</span></span>
<span id="cb14-407"><a href="#cb14-407" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Chapter 8 of <span class="co">[</span><span class="ot">*Introduction to Statistics*</span><span class="co">](https://02402.compute.dtu.dk/enotes/book-IntroStatistics)</span> by Brockhoff</span>
<span id="cb14-408"><a href="#cb14-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-409"><a href="#cb14-409" aria-hidden="true" tabindex="-1"></a><span class="fu">### Analysis of Variance (ANOVA) - *J David Eisenberg* {#sec-anova-eisenberg}</span></span>
<span id="cb14-410"><a href="#cb14-410" aria-hidden="true" tabindex="-1"></a>{{&lt; video https://www.youtube.com/watch?v=ITf4vHhyGpc &gt;}}</span>
<span id="cb14-411"><a href="#cb14-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-412"><a href="#cb14-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-413"><a href="#cb14-413" aria-hidden="true" tabindex="-1"></a><span class="fu">### Anova in R - *Ed Boone* {#sec-anova-boone}</span></span>
<span id="cb14-414"><a href="#cb14-414" aria-hidden="true" tabindex="-1"></a>{{&lt; video https://www.youtube.com/watch?v=Dwd3ha0P8uw &gt;}}</span>
<span id="cb14-415"><a href="#cb14-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-416"><a href="#cb14-416" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exercises</span></span>
<span id="cb14-417"><a href="#cb14-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-418"><a href="#cb14-418" aria-hidden="true" tabindex="-1"></a>::: {.callout-exercise #ex-anova}</span>
<span id="cb14-419"><a href="#cb14-419" aria-hidden="true" tabindex="-1"></a><span class="fu">### ANOVA</span></span>
<span id="cb14-420"><a href="#cb14-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-421"><a href="#cb14-421" aria-hidden="true" tabindex="-1"></a>Load <span class="in">`Results panel.xlsx`</span>. Look at the study design and:</span>
<span id="cb14-422"><a href="#cb14-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-423"><a href="#cb14-423" aria-hidden="true" tabindex="-1"></a>::: {.callout-task}</span>
<span id="cb14-424"><a href="#cb14-424" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Formulate a One-way ANOVA model for the coffees served at different *Temperatures* and the response *bitter*.</span>
<span id="cb14-425"><a href="#cb14-425" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Formulate null-hypothesis and alternative hypothesis between the different coffee temperatures.</span>
<span id="cb14-426"><a href="#cb14-426" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Test the hypothesis.</span>
<span id="cb14-427"><a href="#cb14-427" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Formulate a Two-way ANOVA model for the taste of bitter with the two factors; *Temperature* and *Judge*</span>
<span id="cb14-428"><a href="#cb14-428" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>Formulate null-hypothesis and alternative hypothesis.</span>
<span id="cb14-429"><a href="#cb14-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-430"><a href="#cb14-430" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb14-431"><a href="#cb14-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-432"><a href="#cb14-432" aria-hidden="true" tabindex="-1"></a>::: </span>
<span id="cb14-433"><a href="#cb14-433" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- End exercise callout --&gt;</span></span>
<span id="cb14-434"><a href="#cb14-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-435"><a href="#cb14-435" aria-hidden="true" tabindex="-1"></a>::: {.callout-exercise id=ex-wine-and-one-way-anova}</span>
<span id="cb14-436"><a href="#cb14-436" aria-hidden="true" tabindex="-1"></a><span class="fu">### Wine and one-way ANOVA</span></span>
<span id="cb14-437"><a href="#cb14-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-438"><a href="#cb14-438" aria-hidden="true" tabindex="-1"></a>Wines from four different countries (Argentina, Australia, Chile and South Africa) were analyzed for aroma compounds with GC-MS (gas chromatography coupled with mass spectrometry). The dataset can be found in the file “Wine.xlsx”. The wine data should already be familiar to you otherwise look at the exercises from week 1 and 2.</span>
<span id="cb14-439"><a href="#cb14-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-440"><a href="#cb14-440" aria-hidden="true" tabindex="-1"></a>::: {.callout-task}</span>
<span id="cb14-441"><a href="#cb14-441" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>When working with ANOVA which assumption is then made about the data, and how does the model look?</span>
<span id="cb14-442"><a href="#cb14-442" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>We would like to investigate if the wines from the four different countries are different. State the null hypothesis and the alternative hypothesis.</span>
<span id="cb14-443"><a href="#cb14-443" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Make a combined jitter and boxplot on the variable *X3.Hexenol*. Are there any suspicious samples?</span>
<span id="cb14-444"><a href="#cb14-444" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Make an ANOVA on *X3.Hexenol*, look at the <span class="in">`summary()`</span> and draw conclusions.</span>
<span id="cb14-445"><a href="#cb14-445" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>Compare the result with the boxplot from Q3. Was the result of the ANOVA expected? If yes; why?</span>
<span id="cb14-446"><a href="#cb14-446" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span>We would like to state which countries are significantly different from the others. For this you need to install the R-package <span class="in">`multcomp`</span>. Use the command <span class="in">`TukeyHSD()`</span> to investigate the differences/contrasts between the countries. Use the confidence intervals for judging differences.</span>
<span id="cb14-447"><a href="#cb14-447" aria-hidden="true" tabindex="-1"></a><span class="ss">7. </span>Which countries are significantly different and which are not? Compare with the boxplot produced in Q3.</span>
<span id="cb14-448"><a href="#cb14-448" aria-hidden="true" tabindex="-1"></a><span class="ss">8. </span>Make the boxplot and the ANOVA for the following variables too; *Diethyl.succinate*, *X1.Hexanol*, *Ethyl.hexanoate* and *Ethyl.propanoate*. Are any of these variables different between countries?</span>
<span id="cb14-449"><a href="#cb14-449" aria-hidden="true" tabindex="-1"></a><span class="ss">9. </span>Check for normality of the model residuals by making a qq-plot.</span>
<span id="cb14-450"><a href="#cb14-450" aria-hidden="true" tabindex="-1"></a><span class="ss">    * </span>Hint: You need to extract the residuals from the model, for instance by the function <span class="in">`resid()`</span>. Use <span class="in">`qqnorm()`</span> and <span class="in">`qqline()`</span> to make the plot. </span>
<span id="cb14-451"><a href="#cb14-451" aria-hidden="true" tabindex="-1"></a>    a. Can we trust the assumption about normality? </span>
<span id="cb14-452"><a href="#cb14-452" aria-hidden="true" tabindex="-1"></a>    a. After doing this manually, try the function <span class="in">`plot()`</span> on the <span class="in">`aov()`</span> object, which produces four plots for assumption checking.</span>
<span id="cb14-453"><a href="#cb14-453" aria-hidden="true" tabindex="-1"></a><span class="ss">10. </span>For some of the results, the jitter plot indicates, a few extreme samples. What happens if these are removed? Does the conclusions change?</span>
<span id="cb14-454"><a href="#cb14-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-455"><a href="#cb14-455" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb14-456"><a href="#cb14-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-457"><a href="#cb14-457" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb14-458"><a href="#cb14-458" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- End exercise callout --&gt;</span></span>
<span id="cb14-459"><a href="#cb14-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-460"><a href="#cb14-460" aria-hidden="true" tabindex="-1"></a>::: {.callout-exercise id=ex-diet-and-fat-metabolism-anova}</span>
<span id="cb14-461"><a href="#cb14-461" aria-hidden="true" tabindex="-1"></a><span class="fu">### Diet and fat metabolism - ANOVA</span></span>
<span id="cb14-462"><a href="#cb14-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-463"><a href="#cb14-463" aria-hidden="true" tabindex="-1"></a>The diet is a central factor involved in general health, and especially in relation to obesity, where a balance between intake of protein, fat and carbohydrates, as well as types of these nutrients seems important. Therefore various controlled studies are conducted to show the effect of different diets. A study examining the effect of protein from milk (casein or whey) and amount of fat on growth biomarkers of fat metabolism and type I diabetes was conducted in 40 mice over an intervention period of 14 weeks.</span>
<span id="cb14-464"><a href="#cb14-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-465"><a href="#cb14-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-466"><a href="#cb14-466" aria-hidden="true" tabindex="-1"></a>The data for this exercise is the same as for @ex-diet-and-fat-metabolism-in-r.</span>
<span id="cb14-467"><a href="#cb14-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-468"><a href="#cb14-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-469"><a href="#cb14-469" aria-hidden="true" tabindex="-1"></a>For this exercise we are going to focus on cholesterol as a biomarker related to fat metabolism, and on three types of diet:</span>
<span id="cb14-470"><a href="#cb14-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-471"><a href="#cb14-471" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>High fat with the milk protein casein *HF casein* (n=15).</span>
<span id="cb14-472"><a href="#cb14-472" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>High fat with whey protein from milk *HF whey* (n=15).</span>
<span id="cb14-473"><a href="#cb14-473" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Low fat with the milk protein casein *LF casein* (n=10).</span>
<span id="cb14-474"><a href="#cb14-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-475"><a href="#cb14-475" aria-hidden="true" tabindex="-1"></a>The cholesterol level at the end of the 14 week intervention is listed in @tbl-tbl-diets-summary including some descriptive stats. </span>
<span id="cb14-476"><a href="#cb14-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-477"><a href="#cb14-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-478"><a href="#cb14-478" aria-hidden="true" tabindex="-1"></a>|                         | 1    | 2    | ... | 9    | 10   | 11   | ... | 15   | $\sum{X}$ | $\sum{(X - \bar{X})^2}$ | $\bar{X}$ | $s_{X}$ |</span>
<span id="cb14-479"><a href="#cb14-479" aria-hidden="true" tabindex="-1"></a>|:-----------------------:|-----:|:----:|----:|-----:|-----:|:----:|----:|-----:|----------:|------------------------:|----------:|--------:|</span>
<span id="cb14-480"><a href="#cb14-480" aria-hidden="true" tabindex="-1"></a>| Cholesterol (HF casein) | 4.68 | 3.60 | ... | 4.60 | 4.84 | 4.84 | ... | 4.37 | 67.29     | 4.06                    |           |         |</span>
<span id="cb14-481"><a href="#cb14-481" aria-hidden="true" tabindex="-1"></a>| Cholesterol (HF whey)   | 3.79 | 2.82 | ... | 3.77 | 4.63 | 3.44 | ... | 3.24 | 54.86     | 4.69                    |           |         |</span>
<span id="cb14-482"><a href="#cb14-482" aria-hidden="true" tabindex="-1"></a>| Cholesterol (LF casein) | 3.97 | 3.69 | ... | 3.62 | 3.53 | ...  | ... | ...  | 34.37     | 2.07                    |           |         |</span>
<span id="cb14-483"><a href="#cb14-483" aria-hidden="true" tabindex="-1"></a>: Some summary statistics for cholesterol across the three diets. {#tbl-diets-summary .table-sm}</span>
<span id="cb14-484"><a href="#cb14-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-485"><a href="#cb14-485" aria-hidden="true" tabindex="-1"></a>The total sums of squares is: $SS_{tot} = \sum{(X_{ij} - \bar{\bar{X}})^2} = 18.99$. </span>
<span id="cb14-486"><a href="#cb14-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-487"><a href="#cb14-487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-488"><a href="#cb14-488" aria-hidden="true" tabindex="-1"></a>The first six questions are supposed to be done *by hand* where the computer only is used as a pocket calculator.</span>
<span id="cb14-489"><a href="#cb14-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-490"><a href="#cb14-490" aria-hidden="true" tabindex="-1"></a>::: {.callout-task}</span>
<span id="cb14-491"><a href="#cb14-491" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Calculate descriptive statistics for the three groups </span>
<span id="cb14-492"><a href="#cb14-492" aria-hidden="true" tabindex="-1"></a><span class="ss">    * </span>Hint: Fill in the table the missing values in @tbl-diets-summary.</span>
<span id="cb14-493"><a href="#cb14-493" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Sketch these results in a graph (by pen and paper - no computer).</span>
<span id="cb14-494"><a href="#cb14-494" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>State a model for these data, and a hypothesis of similarity between the three dietary treatments (with regards to cholesterol level).</span>
<span id="cb14-495"><a href="#cb14-495" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Construct an ANOVA table and calculate and fill in the numbers including test statistics ($F_{obs}$) and the corresponding p-value. </span>
<span id="cb14-496"><a href="#cb14-496" aria-hidden="true" tabindex="-1"></a><span class="ss">    * </span>For the translation of $F_{obs}$ to $p$, use the function <span class="in">`pf()`</span> in R.</span>
<span id="cb14-497"><a href="#cb14-497" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>This p-value should be significant. Guided by the initial descriptive stats, do you believe that all three diets are different? Or is there two groups which are close in estimate?</span>
<span id="cb14-498"><a href="#cb14-498" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span>Formulate a hypothesis of similarity between the two most similar groups. Test this contrast.</span>
<span id="cb14-499"><a href="#cb14-499" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb14-500"><a href="#cb14-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-501"><a href="#cb14-501" aria-hidden="true" tabindex="-1"></a>The data can be found in the file <span class="in">`Mouse_diet_intervention.xlsx`</span>. </span>
<span id="cb14-502"><a href="#cb14-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-503"><a href="#cb14-503" aria-hidden="true" tabindex="-1"></a>::: {.callout-task}</span>
<span id="cb14-504"><a href="#cb14-504" aria-hidden="true" tabindex="-1"></a><span class="ss">7. </span>Import the data, and make a plot of cholesterol (<span class="in">`$cholesterol`</span>) and dietary intervention (<span class="in">`$Fat_Protein`</span>)</span>
<span id="cb14-505"><a href="#cb14-505" aria-hidden="true" tabindex="-1"></a><span class="ss">8. </span>Repeat the ANOVA analysis using R with the function <span class="in">`aov()`</span> for construction of model and the function <span class="in">`anova()`</span> for analysis of this model.</span>
<span id="cb14-506"><a href="#cb14-506" aria-hidden="true" tabindex="-1"></a><span class="ss">9. </span>Check that the model assumptions are ok.</span>
<span id="cb14-507"><a href="#cb14-507" aria-hidden="true" tabindex="-1"></a><span class="ss">    * </span><span class="in">`plot(model)`</span> where <span class="in">`model`</span> is the object created by <span class="in">`aov()`</span>.</span>
<span id="cb14-508"><a href="#cb14-508" aria-hidden="true" tabindex="-1"></a><span class="ss">10. </span>For the individual contrasts you can use the function <span class="in">`TukeyHSD()`</span> on the model. </span>
<span id="cb14-509"><a href="#cb14-509" aria-hidden="true" tabindex="-1"></a><span class="ss">    * </span>Be aware that the p-values in this analysis is adjusted for multiple testing, and therefore are bigger than the ones done one by one.</span>
<span id="cb14-510"><a href="#cb14-510" aria-hidden="true" tabindex="-1"></a><span class="ss">11. </span>Based on these results, which dietary component do you think causes differences in cholesterol level?</span>
<span id="cb14-511"><a href="#cb14-511" aria-hidden="true" tabindex="-1"></a><span class="ss">12. </span>There are some indications of differences between *HF whey* and *LF casein*, however, not significant. How many samples would have been needed in order to achieve significance with an appropriate power level?</span>
<span id="cb14-512"><a href="#cb14-512" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb14-513"><a href="#cb14-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-514"><a href="#cb14-514" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb14-515"><a href="#cb14-515" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- End exercise callout --&gt;</span></span>
<span id="cb14-516"><a href="#cb14-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-517"><a href="#cb14-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-518"><a href="#cb14-518" aria-hidden="true" tabindex="-1"></a>::: {.callout-exercise id=ex-diet-and-fat-metabolism-anova-multivariate}</span>
<span id="cb14-519"><a href="#cb14-519" aria-hidden="true" tabindex="-1"></a><span class="fu">### Diet and fat metabolism - multivariate ANOVA</span></span>
<span id="cb14-520"><a href="#cb14-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-521"><a href="#cb14-521" aria-hidden="true" tabindex="-1"></a>In this exercise, we are going to extend the analysis from @ex-diet-and-fat-metabolism-anova to include several biomarkers.</span>
<span id="cb14-522"><a href="#cb14-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-523"><a href="#cb14-523" aria-hidden="true" tabindex="-1"></a>::: {.callout-task}</span>
<span id="cb14-524"><a href="#cb14-524" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Start out by construction of a PCA on the biomarkers: <span class="in">`insulin`</span>, <span class="in">`cholesterol`</span>, <span class="in">`triglycerides`</span>, <span class="in">`NEFA`</span>, <span class="in">`glucose`</span> and <span class="in">`HbA1c`</span> (NEFA = nonesterified fatty acids), including all 40 samples, and comment on the results with respect to differences between diets.  This is computationally identical to the task in @ex-diet-and-fat-metabolism-in-r.</span>
<span id="cb14-525"><a href="#cb14-525" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Repeat the ANOVA for several biomarkers including plotting.</span>
<span id="cb14-526"><a href="#cb14-526" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Zack out the components in the PCA model and glue them together with the original data (use <span class="in">`cbind()`</span>).</span>
<span id="cb14-527"><a href="#cb14-527" aria-hidden="true" tabindex="-1"></a><span class="ss">    * </span>You can find inspiration on how to do this in @ex-mcdonalds-data.</span>
<span id="cb14-528"><a href="#cb14-528" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Use the components from the PCA model as response variables, and repeat the ANOVA (including plotting).</span>
<span id="cb14-529"><a href="#cb14-529" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>Comment on the similarity / dis-similarity between the univariate results, and the ones based on the PCA.</span>
<span id="cb14-530"><a href="#cb14-530" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span>Compare the results (plot and ANOVA) for PC1 and PC6. Why do you think the dietary signal is more pronounced in the first component? </span>
<span id="cb14-531"><a href="#cb14-531" aria-hidden="true" tabindex="-1"></a><span class="ss">    * </span>Hint: Think of how much, and which type of variation that is captured in the individual components.</span>
<span id="cb14-532"><a href="#cb14-532" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb14-533"><a href="#cb14-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-534"><a href="#cb14-534" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb14-535"><a href="#cb14-535" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- End exercise callout --&gt;</span></span>
<span id="cb14-536"><a href="#cb14-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-537"><a href="#cb14-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-538"><a href="#cb14-538" aria-hidden="true" tabindex="-1"></a>::: {.callout-exercise id=ex-analysis-of-coffee-serving-temperature}</span>
<span id="cb14-539"><a href="#cb14-539" aria-hidden="true" tabindex="-1"></a><span class="fu">### Analysis of coffee serving temperature</span></span>
<span id="cb14-540"><a href="#cb14-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-541"><a href="#cb14-541" aria-hidden="true" tabindex="-1"></a>Serving temperature of coffee seems of importance of how this drink is perceived. However, it is not totally clear how this relation is. In order to understand this, studies on the same type of coffee served at different temperature is conducted. In this exercise we are going to use the data from a trained Panel of eight judges, evaluating coffee served at six different temperatures on a set of sensorical descriptors. Each judge is presented with each temperature in a total of four replicates leading to a total of $6 \times 8 \times 4 = 192$ samples. </span>
<span id="cb14-542"><a href="#cb14-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-543"><a href="#cb14-543" aria-hidden="true" tabindex="-1"></a>In the dataset <span class="in">`Results Panel.xlsx`</span>  the results are listed. In this exercise we are going to analyse the differences between the individual temperatures while utilizing the design of repeated scoring by the same judges. This exercise is an extension of @ex-coffee-serving-temp from week one.</span>
<span id="cb14-544"><a href="#cb14-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-545"><a href="#cb14-545" aria-hidden="true" tabindex="-1"></a>::: {.callout-task}</span>
<span id="cb14-546"><a href="#cb14-546" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>We want to summarize data, such that each judge have *one* score for each coffee sample and each attribute (instead of four). </span>
<span id="cb14-547"><a href="#cb14-547" aria-hidden="true" tabindex="-1"></a><span class="ss">    * </span>You can use the <span class="in">`aggregate()`</span> function to average over replicates, which is to retain <span class="in">`Assessor`</span> and <span class="in">`Sample`</span>.</span>
<span id="cb14-548"><a href="#cb14-548" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Plot this descriptive measure for <span class="in">`Intensity`</span> across temperature (x-axis) and join the points from the same judge.</span>
<span id="cb14-549"><a href="#cb14-549" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Make an ANOVA model with the response <span class="in">`Intensity`</span> including both factors (<span class="in">`Temperature`</span> and <span class="in">`Judge`</span>).</span>
<span id="cb14-550"><a href="#cb14-550" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Check out what the function <span class="in">`factor()`</span> is doing? What happens if it is removed (check the degrees of freedoms consumed by the two options).</span>
<span id="cb14-551"><a href="#cb14-551" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>Check that the model assumptions are ok. (<span class="in">`plot(model)`</span> where <span class="in">`model`</span> is the object created by <span class="in">`aov()`</span>).</span>
<span id="cb14-552"><a href="#cb14-552" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span>Comment on these results (in relation to Temperature and Judge).</span>
<span id="cb14-553"><a href="#cb14-553" aria-hidden="true" tabindex="-1"></a><span class="ss">7. </span>Use this data as input for construction of a PCA model, and make a bi-plot.</span>
<span id="cb14-554"><a href="#cb14-554" aria-hidden="true" tabindex="-1"></a><span class="ss">8. </span>What do you see with respect to differences in temperature and judges?</span>
<span id="cb14-555"><a href="#cb14-555" aria-hidden="true" tabindex="-1"></a><span class="ss">9. </span>Zack out the first couple of component and glue them together with the original data.</span>
<span id="cb14-556"><a href="#cb14-556" aria-hidden="true" tabindex="-1"></a><span class="ss">10. </span>Make ANOVA model for component 1 to 5 and find the component with the strongest <span class="in">`Temperature`</span> and <span class="in">`Judge`</span> signature respectively.</span>
<span id="cb14-557"><a href="#cb14-557" aria-hidden="true" tabindex="-1"></a><span class="ss">11. </span>Plot the PCA model with these two components (This is specified by the option <span class="in">`choice = ...`</span>). Color this plot according to <span class="in">`Temperature`</span> and <span class="in">`Judge`</span>.</span>
<span id="cb14-558"><a href="#cb14-558" aria-hidden="true" tabindex="-1"></a><span class="ss">12. </span>Which sensorical markers seems mostly related to differences between <span class="in">`Temperature`</span> and <span class="in">`Judge`</span> respectively?</span>
<span id="cb14-559"><a href="#cb14-559" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb14-560"><a href="#cb14-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-561"><a href="#cb14-561" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb14-562"><a href="#cb14-562" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- End exercise callout --&gt;</span></span>
<span id="cb14-563"><a href="#cb14-563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-564"><a href="#cb14-564" aria-hidden="true" tabindex="-1"></a>::: {.callout-exercise id=ex-carcass-suspension}</span>
<span id="cb14-565"><a href="#cb14-565" aria-hidden="true" tabindex="-1"></a><span class="fu">### Carcass suspension</span></span>
<span id="cb14-566"><a href="#cb14-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-567"><a href="#cb14-567" aria-hidden="true" tabindex="-1"></a>Toughness is found to be the most important quality characteristic in beef. Variation in toughness is primarily related to the muscle fibers and the connective tissue. Connective tissue is thought to be responsible for the relative fixed background toughness, largely affected by animal age. The toughness of the muscle fibers depends on a couple of factors and is more likely to be manipulated by e.g. carcass suspension to prevent post-mortem contraction of the muscle fibers.</span>
<span id="cb14-568"><a href="#cb14-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-569"><a href="#cb14-569" aria-hidden="true" tabindex="-1"></a>An experiment was conducted in order to test the effects of Animal Age, Carcass Suspension and the interaction between Animal Age and Carcass Suspension. The muscle of interest was longissimus dorsi. The hypothesis for the experiment was that pelvic suspension would prevent post-mortem contraction of the muscle fibers and thereby result in a more tender longissimus dorsi compared with suspension in the Achilles tendon. Furthermore, the toughness was believed to increase with increasing age. This increase in toughness was assigned to connective tissue.</span>
<span id="cb14-570"><a href="#cb14-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-571"><a href="#cb14-571" aria-hidden="true" tabindex="-1"></a>In the experiment, animals were slaughtered and the carcasses were spilt. One side was suspended in in the pelvic bone (@fig-carcass, left) and the other side was suspended in the Achilles tendon (@fig-carcass, right). The experiment was balanced and 15 carcass sides were assigned to each group.</span>
<span id="cb14-572"><a href="#cb14-572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-573"><a href="#cb14-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-574"><a href="#cb14-574" aria-hidden="true" tabindex="-1"></a>&lt;div style="width: 50%; margin: auto; text-align: center;"&gt;</span>
<span id="cb14-575"><a href="#cb14-575" aria-hidden="true" tabindex="-1"></a><span class="al">![Left: Pelvic suspension. Right: Achilles suspension.](carcass.png)</span>{#fig-carcass}</span>
<span id="cb14-576"><a href="#cb14-576" aria-hidden="true" tabindex="-1"></a>&lt;/div&gt;</span>
<span id="cb14-577"><a href="#cb14-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-578"><a href="#cb14-578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-579"><a href="#cb14-579" aria-hidden="true" tabindex="-1"></a>In the @tbl-carcass-results are shown the average results from each cell in the design.</span>
<span id="cb14-580"><a href="#cb14-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-581"><a href="#cb14-581" aria-hidden="true" tabindex="-1"></a>| Suspension  | Age 2y | Age 3y | Age 4y |</span>
<span id="cb14-582"><a href="#cb14-582" aria-hidden="true" tabindex="-1"></a>|:------------|-------:|-------:|-------:|</span>
<span id="cb14-583"><a href="#cb14-583" aria-hidden="true" tabindex="-1"></a>| Pelvic (A)  |   58.5 |   65.0 |   66.0 |</span>
<span id="cb14-584"><a href="#cb14-584" aria-hidden="true" tabindex="-1"></a>| Achilles (B)|   72.0 |   82.5 |   93.0 |</span>
<span id="cb14-585"><a href="#cb14-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-586"><a href="#cb14-586" aria-hidden="true" tabindex="-1"></a>: Mean values for the design (n = 15 in each group) {#tbl-carcass-results .table-sm}</span>
<span id="cb14-587"><a href="#cb14-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-588"><a href="#cb14-588" aria-hidden="true" tabindex="-1"></a>::: {.callout-task}</span>
<span id="cb14-589"><a href="#cb14-589" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Sketch these results with the response on the y-axis, one factor on the x-axis, and join the points based on the other factor. What is your first impression on the effect of age of the animal and of suspension method. </span>
<span id="cb14-590"><a href="#cb14-590" aria-hidden="true" tabindex="-1"></a><span class="ss">    * </span>Further, does the lines seem to be deviating from being parallel? (This indicates interaction between the factors).</span>
<span id="cb14-591"><a href="#cb14-591" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Write up a model including interaction term.</span>
<span id="cb14-592"><a href="#cb14-592" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Write up the $H0$ (and the alternative) hypotheses for the main effects in this experiment.</span>
<span id="cb14-593"><a href="#cb14-593" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb14-594"><a href="#cb14-594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-595"><a href="#cb14-595" aria-hidden="true" tabindex="-1"></a>| Source         | SS      | df | MS    | F | p-value |</span>
<span id="cb14-596"><a href="#cb14-596" aria-hidden="true" tabindex="-1"></a>|:---------------|--------:|---:|------:|--:|--------:|</span>
<span id="cb14-597"><a href="#cb14-597" aria-hidden="true" tabindex="-1"></a>| Age            | 3083.7  |    |       |   |         |</span>
<span id="cb14-598"><a href="#cb14-598" aria-hidden="true" tabindex="-1"></a>| Suspension     | 8410.0  |    |       |   |         |</span>
<span id="cb14-599"><a href="#cb14-599" aria-hidden="true" tabindex="-1"></a>| Age*Suspension |         |    |       |   |         |</span>
<span id="cb14-600"><a href="#cb14-600" aria-hidden="true" tabindex="-1"></a>| Error          |         |    | 375.0 | - | -       |</span>
<span id="cb14-601"><a href="#cb14-601" aria-hidden="true" tabindex="-1"></a>| Total          | 43715.0 | 89 | -     | - | -       |</span>
<span id="cb14-602"><a href="#cb14-602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-603"><a href="#cb14-603" aria-hidden="true" tabindex="-1"></a>: ANOVA table for response <span class="in">`shear force`</span>. {#tbl-shear-force .table-sm}</span>
<span id="cb14-604"><a href="#cb14-604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-605"><a href="#cb14-605" aria-hidden="true" tabindex="-1"></a>::: {.callout-task}</span>
<span id="cb14-606"><a href="#cb14-606" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Fill the missing values in the @tbl-shear-force.</span>
<span id="cb14-607"><a href="#cb14-607" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>What factors are having a significant effect (significance level of 0.05)?</span>
<span id="cb14-608"><a href="#cb14-608" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span>Modify the two-way ANOVA model. Should the interaction be included in the final model for the present study? Why/Why not?</span>
<span id="cb14-609"><a href="#cb14-609" aria-hidden="true" tabindex="-1"></a><span class="ss">7. </span>Toughness is explained by muscle fibers and connective tissue. The contribution from muscle fibers is impacted by suspension method. The contribution from connective tissue is impacted by age. Would you expect an effect of the interaction term between suspension method and age? Why/Why not? How does your answer correspond with the answers in question 6?</span>
<span id="cb14-610"><a href="#cb14-610" aria-hidden="true" tabindex="-1"></a><span class="ss">8. </span>Traditionally, carcasses suspension is done by Achilles, what would you recommend based on this study? What are the limitations/assumptions for such a recommendation? </span>
<span id="cb14-611"><a href="#cb14-611" aria-hidden="true" tabindex="-1"></a><span class="ss">    * </span>Hint: Have we checked all muscles? Look at the picture - do you think the conclusions extrapolate to other parts of the animal?</span>
<span id="cb14-612"><a href="#cb14-612" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb14-613"><a href="#cb14-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-614"><a href="#cb14-614" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb14-615"><a href="#cb14-615" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- End exercise callout --&gt;</span></span>
<span id="cb14-616"><a href="#cb14-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-617"><a href="#cb14-617" aria-hidden="true" tabindex="-1"></a>::: {.callout-exercise id=ex-stability-of-oil-2}</span>
<span id="cb14-618"><a href="#cb14-618" aria-hidden="true" tabindex="-1"></a><span class="fu">### Stability of oil under different conditions</span></span>
<span id="cb14-619"><a href="#cb14-619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-620"><a href="#cb14-620" aria-hidden="true" tabindex="-1"></a>This exercise is a direct extension of @ex-stability-of-oil-under-different-conditions.</span>
<span id="cb14-621"><a href="#cb14-621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-622"><a href="#cb14-622" aria-hidden="true" tabindex="-1"></a>Oil are primary made up of triglycerides, where some of the fatty acids are unsaturated. This causes such a product to be susceptible to oxidation both from chemical oxidative agents such as metal ions, or from exposure to light. Oxidation of the unsaturated fatty acids changes the sensorical and physical properties of the oil.</span>
<span id="cb14-623"><a href="#cb14-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-624"><a href="#cb14-624" aria-hidden="true" tabindex="-1"></a>In the southern part of Africa grows a robust bean - the Marama bean. This bean has a favorable dietary composition, including dietary fibers, fats and proteins, as most similar types of nuts, therefore this crop could be utilized for making healthy products by the locals for the locals. One such product is Marama bean oil. A study has been conducted to investigate the oxidative stability of the oil under various conditions. In the dataset <span class="in">`MaramaBeanOilOx.xlsx`</span> are listed the results from such an experiment (including data from both normal and roasted beans). The experimental factors are:</span>
<span id="cb14-625"><a href="#cb14-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-626"><a href="#cb14-626" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Storage time (<span class="in">`Month`</span>)</span>
<span id="cb14-627"><a href="#cb14-627" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Product type (<span class="in">`Product`</span>)</span>
<span id="cb14-628"><a href="#cb14-628" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Storage temperature (<span class="in">`Temperature`</span>)</span>
<span id="cb14-629"><a href="#cb14-629" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Storage condition (<span class="in">`Light`</span>)</span>
<span id="cb14-630"><a href="#cb14-630" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Packaging air (<span class="in">`Air`</span>)</span>
<span id="cb14-631"><a href="#cb14-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-632"><a href="#cb14-632" aria-hidden="true" tabindex="-1"></a>The response variable reflecting oxidative stability is peroxide value and named <span class="in">`PV`</span>.</span>
<span id="cb14-633"><a href="#cb14-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-634"><a href="#cb14-634" aria-hidden="true" tabindex="-1"></a>The first three questions are identical to @ex-stability-of-oil-under-different-conditions.</span>
<span id="cb14-635"><a href="#cb14-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-636"><a href="#cb14-636" aria-hidden="true" tabindex="-1"></a>::: {.callout-task}</span>
<span id="cb14-637"><a href="#cb14-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-638"><a href="#cb14-638" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Read in the data, and subset so that you only include data related to product type <span class="in">`Oil`</span>.</span>
<span id="cb14-639"><a href="#cb14-639" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Make descriptive plots of the response variable <span class="in">`PV`</span> imposing storage temperature, condition, and time. </span>
<span id="cb14-640"><a href="#cb14-640" aria-hidden="true" tabindex="-1"></a><span class="ss">    * </span>Hint: <span class="in">`factor(Temperature):Light`</span> specifies all combinations of these two factors. <span class="in">`facet_grid(.~Month)`</span> splits the plot into several plots according to Month.</span>
<span id="cb14-641"><a href="#cb14-641" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>What do you observe in terms of storage time, temperature and condition from this plot?</span>
<span id="cb14-642"><a href="#cb14-642" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Based on the plot, suggest a model including the three factors <span class="in">`Month`</span>, <span class="in">`Temperature`</span> and <span class="in">`Light`</span>. Which factors do you think is additive (i.e. have the same effect regardless of the other factors), and which do you think interacts?</span>
<span id="cb14-643"><a href="#cb14-643" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>Build a model including all combinations of the three factors. </span>
<span id="cb14-644"><a href="#cb14-644" aria-hidden="true" tabindex="-1"></a><span class="ss">    * </span>That is: <span class="in">`m &lt;- aov(data=Marama.oil, PV~factor(Temperature)*Light*factor(Month))`</span>.</span>
<span id="cb14-645"><a href="#cb14-645" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span>Check the assumption concerning the distribution of the residuals. If necessary, make an appropriate transformation of the response variable, and check that it is doing better in terms of distributional assumptions for the model residuals.</span>
<span id="cb14-646"><a href="#cb14-646" aria-hidden="true" tabindex="-1"></a><span class="ss">7. </span>It seems like we need all combinations of everything. Construct a single variable, that has the seven levels indicating the design, and use this in an ANOVA model. </span>
<span id="cb14-647"><a href="#cb14-647" aria-hidden="true" tabindex="-1"></a><span class="ss">    * </span>Hint: <span class="in">`Allcomp &lt;- factor(Marama.oil$Temperature):Marama.oil$Light:factor(Marama.oil$Month`</span></span>
<span id="cb14-648"><a href="#cb14-648" aria-hidden="true" tabindex="-1"></a><span class="ss">8. </span>Use <span class="in">`TukeyHSD()`</span> on that model to make all pairwise comparisons of the seven individual levels. And comment on what you obtain. Does the initial plot correspond to the pairwise observations?</span>
<span id="cb14-649"><a href="#cb14-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-650"><a href="#cb14-650" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb14-651"><a href="#cb14-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-652"><a href="#cb14-652" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb14-653"><a href="#cb14-653" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- End exercise callout --&gt;</span></span>
<span id="cb14-654"><a href="#cb14-654" aria-hidden="true" tabindex="-1"></a></span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>